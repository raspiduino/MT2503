/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE. 
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*****************************************************************************
 *
 * Filename:
 * ---------
 *  PhoneSetup.c
 *
 * Project:
 * --------
 *  MAUI
 *
 * Description:
 * ------------
 *  This file is intends for phone setup application
 *
 * Author:
 * -------
 * -------
 *
 *============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *============================================================================
 ****************************************************************************/

/***************************************************************************** 
* Include
*****************************************************************************/
/*  Include: MMI header file */
#include "MMI_features.h"
#include "ProtocolEvents.h"
#include "IMERes.h"
#include "CommonScreens.h"
#include "SettingsGexdcl.h"
#include "settingGprots.h"
#include "SettingDefs.h"
#include "PhnsetProt.h"
#include "ATHandlerProt.h"      /* SendATSetGreeting() */
#include "MainMenuDef.h"        /* MAIN_MENU_TITLE_SETTINGS_ICON */
#include "settingprot.h"        /* PhoneSetup Prototype */
#include "CSP.h"        /* CSP_VALUE_ADDED_SERVICES_SERVICE_GROUP, CSP_Language */
#include "SettingProfile.h"     /* WARNING_TONE */
#include "MessagesExDcl.h"      /* GetChildMenuIDIndexByParentMenuID()  */
#include "ScheduledPowerOnOffGProt.h"
#include "PhoneSetup.h"
#include "PhoneSetupGprots.h"
#include "Conversions.h"
#include "UCMGprot.h"
#include "IdleAppProt.h"
#include "RestoreGprot.h"
#include "ProfilesAppGprot.h"
#include "SettingMenuService.h"

#include "Menucuigprot.h"

#include "mmi_rp_app_nitz_def.h"
#include "SSCStringHandle.h"    /* SSC_ENGLISH, ... defination */

#ifdef __MMI_SET_DEF_ENCODING_TYPE__
#include "SSCStringHandle.h"
#endif /* __MMI_SET_DEF_ENCODING_TYPE__ */

#if 0
/* under construction !*/
/* under construction !*/
#endif /* __MMI_AUTO_LANG_EN__ */ 

#ifndef __DISABLE_SHORTCUTS_MENU__
#include "ShortcutsGprots.h"
#endif 

#if defined(__MMI_FE_VECTOR_FONT_ON_FILE_SYSTEM__)
#include "FontManagerGProt.h"
#endif

#ifdef __MMI_GADGET_SUPPORT__
#include "WgtMgrAppGprot.h"
#endif /* __MMI_GADGET_SUPPORT__ */

#ifdef __MMI_PREFER_INPUT_METHOD__
#include "PreferedInputMethodProt.h"  
#endif 

#ifdef __MMI_THEMES_APPLICATION__
#include "MMIThemes.h"
#endif /* __MMI_THEMES_APPLICATION__ */

/*  Include: PS header file */
#ifdef MMI_ON_HARDWARE_P
#include "lcd_if.h"
#include "lcd_sw_inc.h"
#endif /* MMI_ON_HARDWARE_P */ 

#ifdef __MMI_NITZ__
#include "nitz.h"
#endif

#ifdef __NTPD_SUPPORT__
#include "NtpApp.h"
#endif
#if 0
#ifdef __MMI_OP12_TOOLBAR__
/* under construction !*/
#endif /* __MMI_OP12_TOOLBAR__ */
#endif
#include "PhnsetGpio.h"
#include "Menucuigprot.h"
#include "FlightModeGProt.h"
#include "Inlinecuigprot.h"

#include "CphsSrvGprot.h"
#ifndef __DISABLE_SHORTCUTS_IMPL__
#include "mmi_rp_app_shortcuts_def.h"
#endif /* __DISABLE_SHORTCUTS_IMPL__ */
#include "mmi_rp_app_gpio_def.h"

#include "FontDcl.h" /* For MAX_LANGUAGES */

#ifdef __MMI_VUI_SHELL_MSG_VIEWER__
#include "vadp_shell_msg_viewer.h"  /* vadp_shell_mv_refresh_panel */
#endif
#ifdef __DM_LAWMO_SUPPORT__
#include "Dmuigprot.h"
#endif /* __DM_LAWMO_SUPPORT__ */

#include "mmi_rp_app_worldclock_def.h"

#include "DialerCuiGprot.h"

/* auto add by kw_check begin */
#include "MMIDataType.h"
#include "gui_data_types.h"
#include "GlobalResDef.h"
#include "mmi_rp_app_phonesetting_new_def.h"
#include "mmi_rp_app_mainmenu_def.h"
#include "wgui_categories_inputs.h"
#include "ImeGprot.h"
#include "FontRes.h"
#include "GlobalConstants.h"
#include "custom_mmi_default_value.h"
#include "mmi_rp_app_idle_def.h"
#include "IdleAppResDef.h"
#include "mmi_frm_nvram_gprot.h"
#include "string.h"
#include "kal_general_types.h"
#include "MMI_features_type.h"
#include "mmi_phnset_dispchar.h"
#include "SSCStringTable.h"
#include "SettingGenum.h"
#include "nvram_data_items.h"
/*#include "l4c_common_enum.h"*/
#include "ps_public_enum.h"
#include "ps_public_struct.h"
#include "MMI_common_app_trc.h"
#include "mmi_common_app_trc.h"
#include "DebugInitDef_Int.h"
#include "kal_trace.h"
#include "mmiapi_dm_struct.h"
#include "stack_msgs.h"
#include "mmi_frm_events_gprot.h"
#include "wgui_categories_util.h"
#include "mmi_frm_history_gprot.h"
#include "mmi_frm_scenario_gprot.h"
#include "CustDataRes.h"
#include "AlertScreen.h"
#include "mmi_frm_mem_gprot.h"
#include "kal_public_api.h"
#include "Unicodexdcl.h"
#include "CommonScreensResDef.h"
#include "mmi_frm_input_gprot.h"
#include "wgui.h"
#include "nvram_common_defs.h"
#include "device.h"
#include "mmi_msg_struct.h"
#include "mmi_frm_queue_gprot.h"
#include "app_ltlcom.h"
#include "mmi_cb_mgr_gprot.h"
#include "UcmSrvGprot.h"
#include "stack_config.h"
#include "wgui_categories_popup.h"
#include "custom_events_notify.h"
#include "mmi_rp_srv_spof_def.h"
#ifdef __MMI_TELEPHONY_SUPPORT__
#include "mmi_rp_srv_flight_mode_def.h"
#endif
/* auto add by kw_check end */
#if defined(__MMI_TOUCH_SCREEN__)
#include "ImeGprot.h"
#endif
#include "mmi_rp_srv_general_setting_def.h" // Encoding type NVRAM

#include "GeneralSettingSrvGprot.h"
#include "SoundEffect.h"
#ifdef __GENERAL_TTS__
#include "TTSSettingGprot.h"
#endif
#include "ShortcutsGProts.h"
#include "IdleGprot.h"
#include "WPSSProtos.h"
#include "ShortcutsProts.h"
#include "PhnsetWidgetMgrGprot.h"
#include "vapp_launcher_key_gprot.h"
#include "Lang_interface.h"
#ifdef MOTION_SENSOR_SUPPORT
#include "motionsensorgprot.h"
#include "mmi_rp_motion_sensor_def.h"/* motion res in motionsensor.res cmm test*/
#endif
#include "MMI_ap_dcm_config.h"

/***************************************************************************** 
* Define
*****************************************************************************/
#if 0
/* under construction !*/
#endif 

//#ifdef __MMI_TOUCH_SCREEN__
#if 0
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif
#endif /* __MMI_TOUCH_SCREEN__ */ 
/***************************************************************************** 
* Typedef
*****************************************************************************/

/***************************************************************************** 
* Local Variable
*****************************************************************************/
#if 0
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif /* __MMI_AUTO_LANG_EN__ */ 

//#ifdef __MMI_TOUCH_SCREEN__
#if 0
/* under construction !*/
#if defined(__MMI_IME_FTE_ENHANCE__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#else
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif
/* under construction !*/
#endif /* __MMI_TOUCH_SCREEN__ */ 


/* Inline CUI */
cui_inline_item_softkey_struct g_phnset_common_softkey_data = 
{
    {{0, 0},
    {STR_GLOBAL_BACK, 0},
    {0, IMG_GLOBAL_COMMON_CSK}}
};
/* Handwriting setting */
#if (0) //defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
#if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#else
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif /* defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__) */


/***************************************************************************** 
* Global Variable
*****************************************************************************/
PHNSET_CNTX g_phnset_cntx;
PHNSET_CNTX *g_phnset_cntx_p = &g_phnset_cntx;
extern U8 g_dst;

/***************************************************************************** 
* External Variable
*****************************************************************************/
/* Lagnuage */
extern sLanguageDetails *gLanguageArray;
extern U16 gCurrLangIndex;
extern U8 *ItemType[8];
extern PU8 subMenuDataPtrs[MAX_SUB_MENUS];
extern U16 gMaxDeployedLangs;

//#ifdef __MMI_PREFER_INPUT_METHOD__
//extern U8 *inputMethodList[9];
//extern U16 currInputMethodIndex;
//#endif /* __MMI_PREFER_INPUT_METHOD__ */ 

//#if defined(__MMI_MIXED_LANG_SUPPORT__) || defined(__MMI_PREFER_WRITING_LANG__)
//extern ime_writing_lang_struct g_ime_writing_lang_array[MAX_WRITING_LANG];
//#endif /* defined(__MMI_MIXED_LANG_SUPPORT__) || defined(__MMI_PREFER_WRITING_LANG__) */ 

/***************************************************************************** 
* Global Function
*****************************************************************************/

/***************************************************************************** 
* External Function
*****************************************************************************/
#ifdef __MMI_AUDIO_PLAYER__	
void mmi_audply_encoding_type_change_callback(void);
#endif

#ifdef __MMI_MEDIA_PLAYER__	
void mmi_medply_encoding_type_change_callback(void);
#endif

/*****************************************************************************
* Local Function 
*****************************************************************************/
/* AT handler */
#ifndef __MMI_PHNSET_AT_DISABLE__
static void mmi_phnset_init_at_handler(void);
#endif

/* Menu CUI */
static mmi_ret mmi_phnset_menu_handler(mmi_event_struct *param);
static mmi_ret mmi_phnset_main_menu_handler(cui_menu_event_struct *param, MMI_ID parent_gid);
static mmi_ret mmi_phnset_main_menu_entry_handler(cui_menu_event_struct *param, MMI_ID parent_gid);
#ifndef __MMI_PHNSET_SLIM__    
static mmi_ret mmi_phnset_main_menu_highlight_handler(cui_menu_event_struct * param, MMI_ID parent_gid);
#endif
static mmi_ret mmi_phnset_main_menu_select_handler(cui_menu_event_struct *param, MMI_ID parent_gid);
static mmi_ret mmi_phnset_main_menu_close_handler(cui_menu_event_struct *param, MMI_ID parent_gid);

static void mmi_phnset_init_main_menu(void);
static void mmi_phnset_init_language_menu(void);
static mmi_ret mmi_phnset_language_menu_proc(mmi_event_struct *param);
static void mmi_phnset_set_language_menu_hint(MMI_ID menucui_id);

#ifdef __MMI_CHANGABLE_FONT__
static mmi_ret mmi_phnset_font_size_proc(mmi_event_struct *param);
static void mmi_phnset_init_font_size_list(void); 
static void mmi_phnset_set_font_size_hint(MMI_ID menucui_id);
#endif /* __MMI_CHANGABLE_FONT__ */



/* Definition is missing */
void PhnsetDefEncodingSelectHandler(U8 highlight_id);

/* Language */
#ifndef __MMI_PHNSET_AT_DISABLE__
#ifndef __SLIM_AT__
static void SendLangChange2AT(U8 code, int mod_id);
#endif /*__SLIM_AT__*/
static void ATSetLanguage(void *msg, int mod_id);
#endif
static void mmi_phnset_entry_set_language(MMI_ID parent_id);
static void PhnsetLangLSKHandler(void);
#if 0
/* under construction !*/
/* under construction !*/
#endif /* __MMI_AUTO_LANG_EN__ */

/* Encoding Type */
#ifdef __MMI_SET_DEF_ENCODING_TYPE__
static void EntryPhnsetDefEncoding(MMI_ID parent_gid);
static void mmi_phnset_init_encoding_menu(void);
static mmi_ret mmi_phnset_encoding_menu_proc(mmi_event_struct *param);
static void mmi_phnset_set_encoding_menu_hint(MMI_ID menucui_id);
#endif


/* UART */
#ifdef __GEMINI__
#ifndef __MMI_PHNSET_AT_DISABLE__
static void EntryPhnsetUARTSetup(MMI_ID parent_gid);
/*static void PhnsetUARTSetupSelectYes(void);*/
static void mmi_phnset_set_uart(U16 select_id);
static mmi_ret mmi_phnset_UART_proc(mmi_event_struct *param);
static void mmi_phnset_init_UART_list(void);
static void mmi_phnset_set_UART_setup_hint(MMI_ID menucui_id);
static void mmi_phnset_UART_setup_confirm(void);
static void  mmi_phnset_UART_setup_reboot(void);
static void mmi_phnset_UART_setup_reboot_req(void);
static void mmi_phnset_UART_setup_reboot_rsp(void *msg);
static void mmi_phnset_UART_setup_reboot_prcessing(void);
#endif
#endif /* __GEMINI__ */

/* GPIO */
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTING_RODATA" , code = "DYNAMIC_CODE_SETTING_ROCODE"
#endif
/*****************************************************************************
 * FUNCTION
 *  InitPhoneSetupCntx
 * DESCRIPTION
 *  This function is to initialize phone setup context
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void InitPhoneSetupCntx(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    //S16 Err = 0;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* Common */
    g_phnset_cntx_p->curHightlightItem = 0;
#ifndef __MMI_PHNSET_SLIM__    
    g_phnset_cntx_p->ScrAnchor = IDLE_SCREEN_ID;
#endif
    /* Set Time and Date */
    g_phnset_cntx_p->currentCity = 0;
    g_phnset_cntx_p->CurHomeCityStrID = 0;
    g_phnset_cntx_p->CurHomeCityStrPtr = 0;
    g_phnset_cntx_p->CurTimeFmt = 0;
    g_phnset_cntx_p->CurDateFmt = 0;
#ifndef __MMI_PHNSET_SLIM__    
    g_phnset_cntx_p->AM_PM_flag = NULL;
#endif

	//ReadValue(CURRENT_CITY, &(g_phnset_cntx_p->currentCity), DS_BYTE, &Err);
	ReadValueSlim(CURRENT_CITY, &(g_phnset_cntx_p->currentCity), DS_BYTE);
    if (g_phnset_cntx_p->currentCity == 0xff)
    {
        g_phnset_cntx_p->currentCity = 0;
        //WriteValue(CURRENT_CITY, &g_phnset_cntx_p->currentCity, DS_BYTE, &Err);
		WriteValueSlim(CURRENT_CITY, &(g_phnset_cntx_p->currentCity), DS_BYTE);
    }

    //ReadValue(NVRAM_SETTING_DT_DST, &(g_phnset_cntx_p->currentDST), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_SETTING_DT_DST, &(g_phnset_cntx_p->currentDST), DS_BYTE);
    if (g_phnset_cntx_p->currentDST == 0xff)
    {
        g_phnset_cntx_p->currentDST = 0;
        //WriteValue(NVRAM_SETTING_DT_DST, &g_phnset_cntx_p->currentDST, DS_BYTE, &Err);
		WriteValueSlim(NVRAM_SETTING_DT_DST, &g_phnset_cntx_p->currentDST, DS_BYTE);
        g_dst = g_phnset_cntx_p->currentDST;
    }

    memset(&(g_phnset_cntx_p->settime), 0, sizeof(PHNSET_DATETIME_STRUCT));
#ifndef __MMI_PHNSET_SLIM__    

    /* NITZ */
    g_phnset_cntx_p->NITZDirtyFlag = MMI_FALSE;
    g_phnset_cntx_p->curNITZStatus = 0;
#endif    

    /* Phone Setup */
#ifndef __MMI_PHNSET_SLIM__    
    g_phnset_cntx_p->ShowOwnNumDirtyFlag = MMI_FALSE;
    g_phnset_cntx_p->ShowDtDirtyFlag = MMI_FALSE;
#endif    
    g_phnset_cntx_p->curShowDtStatus = 0;
#ifdef __MMI_IDLE_SCREEN_OWNER_NUMBER__    
    g_phnset_cntx_p->curShowOwnNumStatus = mmi_phnset_show_owner_number_is_on(MMI_SIM1);
#ifdef __MMI_DUAL_SIM_MASTER__    
/* under construction !*/
#endif
#endif
#if 0
/* under construction !*/
#if defined(__MMI_OPERATOR_NAME_MENU__)
/* under construction !*/
#endif 
#endif

#if 0
#if defined(__MMI_CALENDAR_ON_IDLE_SCREEN__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
        #if (defined(__MMI_MAINLCD_240X400__) || defined(__MMI_MAINLCD_320X480__))
/* under construction !*/
	#else	
/* under construction !*/
	#endif
/* under construction !*/
#endif
#endif
#if defined(__MMI_DUAL_CLOCK__)
    //ReadValue(NVRAM_SET_DUALCLOCK_IDLESCREEN, &(g_phnset_cntx_p->curDualClockStatus), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_SET_DUALCLOCK_IDLESCREEN, &(g_phnset_cntx_p->curDualClockStatus), DS_BYTE);
    //if (g_phnset_cntx_p->curDualClockStatus == 0xFF || Err != NVRAM_READ_SUCCESS)
	if (g_phnset_cntx_p->curDualClockStatus == 0xFF)
    {
        g_phnset_cntx_p->curDualClockStatus = 0;
    }
#ifndef __MMI_WC_TZ_SUPPORT__
    g_phnset_cntx_p->curDualClockStatus = 0;
#endif
#endif

#ifdef __MMI_MAINMENU_STYLE_CHANGE_EN__
    g_phnset_cntx_p->MenuStyle = 0;
#endif 
    
#ifdef __MMI_MOTION_DIAL__
    g_phnset_cntx_p->DialStyle = 0;
#endif /* __MMI_MOTION_DIAL__ */

#ifdef __MMI_SCREEN_SWITCH_EFFECT__
    g_phnset_cntx_p->curScrSwitchEffect = __MMI_SCREEN_SWITCH_EFFECT_SETTING__;
#endif /* __MMI_SCREEN_SWITCH_EFFECT__ */

#ifdef __MMI_DUAL_CLOCK__
    g_phnset_cntx_p->curHomeScreenStatus = 1;
#endif /* __MMI_DUAL_CLOCK__ */

    /* Language */
    g_phnset_cntx_p->ppLang = NULL;
#ifndef __MMI_PHNSET_SLIM__    
    g_phnset_cntx_p->UsrLangIdx = 0;
    g_phnset_cntx_p->LP = CBS0_LANG_UNSPECIFIED;
#endif    

    /* Wallpaper & Screen Saver */
#ifndef __MMI_PHNSET_SLIM__    
    g_phnset_cntx_p->storage_invalid = MMI_FALSE;
    g_phnset_cntx_p->WPSSPreviewScrFlag = 1;
#endif
#ifndef __SLIM_AT__
    g_phnset_cntx_p->curtWpID = 0;
#endif
#ifdef __MMI_SUB_WALLPAPER__
    g_phnset_cntx_p->curtSubWpID = 0;
#endif 
#ifndef __MMI_PHNSET_SLIM__    

    g_phnset_cntx_p->curSSStatus = 0;
    g_phnset_cntx_p->curSSWaitTime = 0;
    g_phnset_cntx_p->SSStatusInlineHilite = 0;
#endif    
    g_phnset_cntx_p->SSWaitStatusInlineHilite = 2;
    g_phnset_cntx_p->wpss_type = MMI_PHNSET_TYPE_WP;

    memset(g_phnset_cntx_p->SysWPSSList, 0, sizeof(g_phnset_cntx_p->SysWPSSList));
#ifndef __MMI_PHNSET_SLIM__    
    memset(g_phnset_cntx_p->DwnlWPSSList, 0, sizeof(g_phnset_cntx_p->DwnlWPSSList));
#endif
    /*init sound effect settings, this shall be done before set lang by nvram 
    since it might effect equalizer values*/
    InitSoundEffect();

    srv_setting_init_language();
#ifdef __MMI_SET_DEF_ENCODING_TYPE__
    if (srv_setting_get_encoding_type() == 0xFF)
    {
        if (mmi_lang_support(SSC_ENGLISH) >= 0)
        {
            mmi_chset_enum encoding_type = mmi_chset_get_english_default_chset();
            srv_setting_set_encoding_type(encoding_type);
        #ifdef __MMI_AUDIO_PLAYER__
            mmi_audply_encoding_type_change_callback();
        #endif

        #ifdef __MMI_MEDIA_PLAYER__
    	    mmi_medply_encoding_type_change_callback();
	    #endif
        }
        else
        {
            srv_setting_set_encoding_type_by_language();
        }
    }

    g_chset_text_encoding = srv_setting_get_encoding_type();

#endif /* __MMI_SET_DEF_ENCODING_TYPE__ */ 

#ifdef __MMI_SCREEN_SWITCH_EFFECT__
    //ReadValue(NVRAM_SET_SCREFFECT_STYLE, &(g_phnset_cntx_p->curScrSwitchEffect), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_SET_SCREFFECT_STYLE, &(g_phnset_cntx_p->curScrSwitchEffect), DS_BYTE);
    if (g_phnset_cntx_p->curScrSwitchEffect == 0xFF)
    {
        g_phnset_cntx_p->curScrSwitchEffect = __MMI_SCREEN_SWITCH_EFFECT_SETTING__;
    }
#endif /* __MMI_SCREEN_SWITCH_EFFECT__ */

#ifdef __MMI_BT_BOX_TEST_DIALER_PAD_STYLE__ 
	ReadValue(NVRAM_DISPCHAR_BT_BOX_DIALER_TYPE, &(g_phnset_cntx_p->curBtBoxDialerType), DS_BYTE, &Err);
    if (g_phnset_cntx_p->curBtBoxDialerType == 0xFF)
    {
        g_phnset_cntx_p->curBtBoxDialerType = MMI_PHNSET_BT_BOX_TYPE1;
    }

    ReadValue(NVRAM_DISPCHAR_BT_BOX_PICKER_TYPE, &(g_phnset_cntx_p->curBtBoxPickerType), DS_BYTE, &Err);
    if (g_phnset_cntx_p->curBtBoxPickerType == 0xFF)
    {
        g_phnset_cntx_p->curBtBoxPickerType = MMI_PHNSET_BT_BOX_PICKER_TYPE1;
    }
#endif  //__MMI_BT_BOX_TEST_DIALER_PAD_STYLE__
#if 0
/* under construction !*/
#if defined(__MMI_OP11_HOMESCREEN_0301__) || defined(__MMI_OP11_HOMESCREEN_0302__) || defined(__MMI_OP11_HOMESCREEN__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif /* defined(__MMI_OP11_HOMESCREEN_0301__) || defined(__MMI_OP11_HOMESCREEN_0302__) */
#endif
#ifdef __MMI_MAINMENU_STYLE_CHANGE_EN__
    //ReadValue(NVRAM_SET_MAINMENU_STYLE, &(g_phnset_cntx_p->MenuStyle), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_SET_MAINMENU_STYLE, &(g_phnset_cntx_p->MenuStyle), DS_BYTE);
    if (g_phnset_cntx_p->MenuStyle == 0xFF 
#ifndef __MMI_MOTION_MAINMENU__        
        || g_phnset_cntx_p->MenuStyle >= PHNSET_MAINMENU_STYLE_MAX
#endif /* __MMI_MOTION_MAINMENU__ */
        )
    {
        g_phnset_cntx_p->MenuStyle = 0;
    }
#endif /* __MMI_MAINMENU_STYLE_CHANGE_EN__ */ 

#ifdef __MMI_MOTION_DIAL__      
   // ReadValue(NVRAM_SET_DIAL_STYLE, &(g_phnset_cntx_p->DialStyle), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_SET_DIAL_STYLE, &(g_phnset_cntx_p->DialStyle), DS_BYTE);
    //if (g_phnset_cntx_p->DialStyle == 0xFF || Err != NVRAM_READ_SUCCESS)
	if (g_phnset_cntx_p->DialStyle == 0xFF )
    {
        g_phnset_cntx_p->DialStyle = 0;
    }
#endif  /* __MMI_MOTION_DIAL__ */

#if (0) //defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif /* defined(__MMI_TOUCH_SCREEN__) */ 

#ifdef __MMI_TIMEZONE_CHANGE_DATETIME__
    //ReadValue(NVRAM_AUTOUPDATE_DT_STATUS, &(g_phnset_cntx_p->curDTUpdateStatus), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_AUTOUPDATE_DT_STATUS, &(g_phnset_cntx_p->curDTUpdateStatus), DS_BYTE);

    //if (g_phnset_cntx_p->curDTUpdateStatus == 0xFF || Err != NVRAM_READ_SUCCESS)
	if (g_phnset_cntx_p->curDTUpdateStatus == 0xFF)
    {
        g_phnset_cntx_p->curDTUpdateStatus = 0;
    }
#endif /* __MMI_TIMEZONE_CHANGE_DATETIME__ */

#ifdef __MMI_VUI_HOMESCREEN__
	//ReadValue(NVRAM_VUI_PHNSET_HOMESCREEN, &(g_phnset_cntx_p->vui_home_screen), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_VUI_PHNSET_HOMESCREEN, &(g_phnset_cntx_p->vui_home_screen), DS_BYTE);
	
    //if (g_phnset_cntx_p->vui_home_screen == 0xFF || Err != NVRAM_READ_SUCCESS)
	if (g_phnset_cntx_p->vui_home_screen == 0xFF)
    {
        g_phnset_cntx_p->vui_home_screen = 1;
    }

	//WriteValue(NVRAM_VUI_PHNSET_HOMESCREEN, &(g_phnset_cntx_p->vui_home_screen), DS_BYTE, &Err);
	WriteValueSlim(NVRAM_VUI_PHNSET_HOMESCREEN, &(g_phnset_cntx_p->vui_home_screen), DS_BYTE);
#endif /* __MMI_VUI_HOMESCREEN__ */

#ifdef __MMI_VUI_MAINMENU__
	//ReadValue(NVRAM_VUI_PHNSET_MAINMENU_EFFECT, &(g_phnset_cntx_p->vui_mm_effect), DS_BYTE, &Err);
	ReadValueSlim(NVRAM_VUI_PHNSET_MAINMENU_EFFECT, &(g_phnset_cntx_p->vui_mm_effect), DS_BYTE);
	
    //if (g_phnset_cntx_p->vui_mm_effect == 0xFF || Err != NVRAM_READ_SUCCESS)
	 if (g_phnset_cntx_p->vui_mm_effect == 0xFF)
    {
        g_phnset_cntx_p->vui_mm_effect = 0;
    }

	//WriteValue(NVRAM_VUI_PHNSET_MAINMENU_EFFECT, &(g_phnset_cntx_p->vui_mm_effect), DS_BYTE, &Err);
	WriteValueSlim(NVRAM_VUI_PHNSET_MAINMENU_EFFECT, &(g_phnset_cntx_p->vui_mm_effect), DS_BYTE);
#endif /* __MMI_VUI_MAINMENU__ */
}
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif

/********/
/* Profile */
/********/
#ifndef __MMI_PHNSET_AT_DISABLE__
/*****************************************************************************
 * FUNCTION
 *  ATSetProfileHandler
 * DESCRIPTION
 *  AT command set profile
 * PARAMETERS
 *  msg     [?]     Wall paper/tone/home city/theme/short cut setting request
 * RETURNS
 *  void
 *****************************************************************************/
static void ATSetProfileHandler(void *msg, int mod_id)
{
#ifndef __SLIM_AT__    
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    mmi_set_mmi_default_prof_ind_struct *mmi_set_prof_struct = (mmi_set_mmi_default_prof_ind_struct*) msg;

    mmi_at_general_res_req_struct *msgReq;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    msgReq = (mmi_at_general_res_req_struct*) OslConstructDataPtr(sizeof(mmi_at_general_res_req_struct));
    msgReq->result = MMI_FALSE;

    if (mmi_set_prof_struct->op != 1)   /* Query command, not imlpemented, send response with error result to L4 */
    {
        goto MMILAB_ATSETPROF_END;
    }

    switch (mmi_set_prof_struct->category)
    {
        case 0: /* Wallpaper */
        {
            if (PhnsetSetDisplayFromAT((U8) (mmi_set_prof_struct->param3 - 1), (U8) MMI_PHNSET_TYPE_WP) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
        case 2: /* Home City */
        {
            if (ATSetHomeCity((U8) (mmi_set_prof_struct->param3)) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
    #if defined(__MMI_THEMES_APPLICATION__)
        case 3: /* Theme */
        {
            if (ATSetTheme((U8) (mmi_set_prof_struct->param3 - 1)) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
    #endif /* defined(__MMI_THEMES_APPLICATION__) */ 
    #ifndef __DISABLE_SHORTCUTS_IMPL__
        case 4: /* Shortcut */
        {
            if (ATSetShortcuts((PU8) mmi_set_prof_struct->param4) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
    #endif /* __DISABLE_SHORTCUTS_IMPL__ */ 
        case 5: /* Screen Saver */
        {
            if (PhnsetSetDisplayFromAT((U8) (mmi_set_prof_struct->param3 - 1), (U8) MMI_PHNSET_TYPE_SS) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
    #ifdef __MMI_POWER_ON_OFF_DISPLAY__
        case 6: /* Power On */
        {
            if (PhnsetSetDisplayFromAT((U8) (mmi_set_prof_struct->param3 - 1), (U8) MMI_PHNSET_TYPE_PWRON) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
        case 7: /* Power Off */
        {
            if (PhnsetSetDisplayFromAT((U8) (mmi_set_prof_struct->param3 - 1), (U8) MMI_PHNSET_TYPE_PWROFF) == MMI_TRUE)
            {
                msgReq->result = MMI_TRUE;
            }

            break;
        }
    #endif /* __MMI_POWER_ON_OFF_DISPLAY__ */ 
        default:
            msgReq->result = MMI_FALSE;
            break;
    }

  MMILAB_ATSETPROF_END:
    mmi_frm_send_ilm((oslModuleType)mod_id, MSG_ID_MMI_AT_GENERAL_RES_REQ, (oslParaType*)msgReq, NULL);
#endif /* __SLIM_AT__ */
}
#endif

#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif
/*****************************************************************************
 * FUNCTION
 *  InitPhoneSetupApp
 * DESCRIPTION
 *  This function is to register highlight handler for Phonesetup
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void InitPhoneSetupApp(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    MMI_TRACE(MMI_COMMON_TRC_G7_SETTING, MMI_PHNSET_INIT_PHONESETUP_APP);

#ifdef __MMI_CHANGABLE_FONT__
    PhnsetReadFontSize();   /* __USB_IN_NORMAL_MODE__ */
#endif /* __MMI_CHANGABLE_FONT__ */ 

/*    InitPhoneSetupGPIO(); */
#ifdef __MMI_TIMEZONE_SETTING__
#if !defined(__MMI_HIDE_HOMECITY__) && defined(__MMI_TWO_LAYER_HOMECITY__) 
    mmi_dt_init_gmt_tz_table();
#endif 
#endif /* __MMI_TIMEZONE_SETTING__ */
#ifndef __MMI_PHNSET_AT_DISABLE__
    mmi_phnset_init_at_handler();
#endif

#ifdef __MMI_VUI_LAUNCHER_KEY__
	mmi_phnset_shortcut_manager_init();	
	mmi_phnset_widget_manager_init();
#endif
#if (defined(__MMI_VUI_LAUNCHER_KEY__) || defined(__MMI_VUI_LAUNCHER__)) && defined(__MMI_VUI_MAIN_MENU_SWITCH_EFFECT__)
	mmi_phnset_menu_effect_init();
#endif
}

#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init
 * DESCRIPTION
 *  use for DCM
 * PARAMETERS
 *  
 * RETURNS
 *  static void
 *****************************************************************************/

void mmi_phnset_init(void)
{
#ifdef __MMI_AP_DCM_SETTING__
  mmi_ap_send_dcm_load_evt(DYNAMIC_CODE_COMPRESS_SETTINGS);
#endif
  InitPhoneSetupCntx();
  InitPhoneSetupApp();
#ifdef __MMI_AP_DCM_SETTING__  
  mmi_ap_send_dcm_unload_evt(DYNAMIC_CODE_COMPRESS_SETTINGS);
#endif
}
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_at_handler
 * DESCRIPTION
 *  Init AT handler for phone setting APP 
 * PARAMETERS
 *  
 * RETURNS
 *  static void
 *****************************************************************************/
#ifndef __MMI_PHNSET_AT_DISABLE__
static void mmi_phnset_init_at_handler(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
 
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* Language */
//    SetProtocolEventHandler(AtQueryLangIndHdlr, PRT_MMI_EQ_QUERY_LANGUAGE_REQ_IND);    
    SetProtocolEventHandler(ATSetLanguage, PRT_MMI_EQ_SET_LANGUAGE_REQ_IND);        

    /* Restore */
    SetProtocolEventHandler(ATRstFactoryDefault, PRT_MMI_FACTORY_RESTORE_REQ_IND);
    mmi_phnset_date_and_time_init_at_handler();
	
    SetProtocolEventHandler(ATSetProfileHandler, PRT_MMI_SET_MMI_DEFAULT_PROF_IND);
	
	/* flight mode */
#ifdef __MMI_TELEPHONY_SUPPORT__
    SetProtocolEventHandler(mmi_mode_switch_set_flight_mode_from_at, MSG_ID_MMI_NW_CFUN_STATE_REQ_IND);
#endif
}
#endif
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif
/*****************************************************************************
 * FUNCTION
 *  HighlightPhnsetScr
 * DESCRIPTION
 *  This function is highlight handler for Phonesetup
 *  Follow functions: EntryPhnsetScr
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void HighlightPhnsetScr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* 1 Change left soft key icon and label */
    ChangeLeftSoftkey(STR_GLOBAL_OK, IMG_GLOBAL_OK);
    /* 2 Change right soft key icon and label */
    ChangeRightSoftkey(STR_GLOBAL_BACK, IMG_GLOBAL_BACK);

    /* 3 Register function for left soft key */
    SetLeftSoftkeyFunction(EntryPhnsetScr, KEY_EVENT_UP);
    SetCenterSoftkeyFunction(EntryPhnsetScr, KEY_EVENT_UP);
    /* 4 Register function for right soft key */
    //SetRightSoftkeyFunction(GoBackHistory, KEY_EVENT_UP);
}

/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetScr
 * DESCRIPTION
 *  This function is Entry function for Phonesetup
 * PARAMETERS
 *  void       
 * RETURNS
 *  void
 *****************************************************************************/
void EntryPhnsetScr(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    MMI_ID main_menu_cui_id;
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    mmi_frm_group_create_ex(
        GRP_ID_ROOT,
        GRP_ID_PHNSET_MENU,
        mmi_phnset_menu_handler,
        NULL, 
        MMI_FRM_NODE_SMART_CLOSE_FLAG);
    
    
    main_menu_cui_id = cui_menu_create(
        GRP_ID_PHNSET_MENU,
        CUI_MENU_SRC_TYPE_RESOURCE,
        CUI_MENU_TYPE_APPMAIN,
        MENU9102_INITIAL_SETUP,
        MMI_FALSE,
        NULL);

    
    cui_menu_set_default_title_image_by_id(main_menu_cui_id, MAIN_MENU_TITLE_SETTINGS_ICON);
    cui_menu_run(main_menu_cui_id);
    
}
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif

#ifdef __MMI_NITZ__
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_nitz_text_hint
 * DESCRIPTION
 *  Set hint for nitz
 * PARAMETERS
 *  
 * RETURNS
 *  static void
 *****************************************************************************/
static void mmi_phnset_set_nitz_text_hint(MMI_ID menucui_id)
{
	/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
	
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    cui_menu_set_item_hint(
        menucui_id,
        MENU_ID_NITZ_APP,
        (WCHAR*)GetString(mmi_nitz_get_curr_nitz_string()));
}

#endif /* __MMI_NITZ__ */

#if (0) //defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
    #if defined (__MMI_IME_V3__)
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
    #endif
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif /* #if defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__) */ 
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif
#ifdef __MMI_SET_DEF_ENCODING_TYPE__
/*****************************************************************************
 * FUNCTION
 *  PhnsetDefEncodingSelectHandler
 * DESCRIPTION
 *  This function is LSK handler for Phonesetup->Default Encoding Type -> X
 *  Follow functions:
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void PhnsetDefEncodingSelectHandler(U8 highlight_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    mmi_chset_enum chset_list[CHSET_TOTAL];
    mmi_chset_enum default_chset;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    mmi_chset_get_chset_list_by_language(chset_list, &default_chset);
    srv_setting_set_encoding_type(chset_list[highlight_id]);

    #ifdef __MMI_AUDIO_PLAYER__
        mmi_audply_encoding_type_change_callback();
    #endif

    #ifdef __MMI_MEDIA_PLAYER__
    	mmi_medply_encoding_type_change_callback();
	#endif

    mmi_popup_display_simple_ext(STR_GLOBAL_DONE, MMI_EVENT_SUCCESS, GRP_ID_ROOT, NULL);
    mmi_frm_group_close(GRP_ID_PHNSET_DEF_ENCODING_TYPE);
}


/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetDefEncoding
 * DESCRIPTION
 *  This function is Entry function for Phonesetup-> Default encoding type
 *  Following functions:
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
static void EntryPhnsetDefEncoding(MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
        mmi_phnset_appcreate_menucui_create(
        parent_gid,
        GRP_ID_PHNSET_DEF_ENCODING_TYPE,
        MENU_SETTING_DEF_ENCODING_TYPE,
        mmi_phnset_encoding_menu_proc);
}

/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_encoding_menu
 * DESCRIPTION
 *  Init the prefer encoding menu
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_init_encoding_menu(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    phnset_radio_button_menu_data_struct radio_button_menu;
    U16 nStrItemList[MAX_SUB_MENUS];
    mmi_chset_enum chset_list[CHSET_TOTAL];
    mmi_chset_enum default_chset;    
    U8 nNumofItem;
    U8 highlight_item = 0;
    U8 i;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    nNumofItem = mmi_chset_get_chset_list_by_language(chset_list, &default_chset);
    for (i = 0; i < nNumofItem; i++)
    {
        if (srv_setting_get_encoding_type()== chset_list[i])
        {
            highlight_item = i;
        }
        nStrItemList[i] = mmi_chset_get_chset_string(chset_list[i]);
    }

    radio_button_menu.group_id = GRP_ID_PHNSET_DEF_ENCODING_TYPE;
    radio_button_menu.menu_title_str_id = STR_DEF_ENCODING_TYPE_TITLE;
    radio_button_menu.menu_icon_id = MAIN_MENU_TITLE_SETTINGS_ICON;
    radio_button_menu.menu_item_num = nNumofItem;
    radio_button_menu.menu_item_str_list = NULL;
    radio_button_menu.menu_item_str_id_list = nStrItemList;
    radio_button_menu.highlighted_item_idx = highlight_item;

    mmi_phnset_init_radio_button_menu(&radio_button_menu);
}



/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_encoding_menu_proc
 * DESCRIPTION
 *  Proc function for prefer encoding setup menu 
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  mmi_ret
 *****************************************************************************/
static mmi_ret mmi_phnset_encoding_menu_proc(mmi_event_struct *param)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (param->evt_id)
    {
    case EVT_ID_CUI_MENU_LIST_ENTRY:
        mmi_phnset_init_encoding_menu();
        break;
    case EVT_ID_CUI_MENU_ITEM_SELECT:
    case EVT_ID_CUI_MENU_ITEM_TAP:
        PhnsetDefEncodingSelectHandler(((cui_menu_event_struct*)param)->highlighted_menu_id);
    	break;

    case EVT_ID_CUI_MENU_CLOSE_REQUEST:
        cui_menu_close(mmi_frm_group_get_active_id());
        break;
        
    case EVT_ID_GROUP_DEINIT:
        if (param->user_data)
    	{
    	    OslMfree(param->user_data);
    	}
        break;
        
    default:
    	break;
    }
    return MMI_RET_OK;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_encoding_menu_hint
 * DESCRIPTION
 *  Set hint for encoding menu 
 * PARAMETERS
 *  menucui_id
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_set_encoding_menu_hint(MMI_ID menucui_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    CHAR* hintStr;
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    hintStr = (CHAR*) GetString(mmi_chset_get_chset_string(srv_setting_get_encoding_type()));
    cui_menu_set_item_hint(
        menucui_id,
        MENU_SETTING_DEF_ENCODING_TYPE,
        (WCHAR*)hintStr);    
}

#endif /* __MMI_SET_DEF_ENCODING_TYPE__ */ 
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif
/*****************************************************************************
 * FUNCTION
 *  PhnsetGetDefEncodingType
 * DESCRIPTION
 *  This function is export function for applications to query the current encoding type setting
 *  Follow functions:
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
U8 PhnsetGetDefEncodingType(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    return g_chset_text_encoding; 

}


/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetLang
 * DESCRIPTION
 *  This function is Entry function for Phonesetup->IdleScreenDisplay
 *  Following functions:
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void EntryPhnsetLang(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    mmi_phnset_entry_set_language(GRP_ID_ROOT);
}

#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_entry_set_language
 * DESCRIPTION
 *  Entry function for set language menu 
 * PARAMETERS
 *  
 * RETURNS
 *  static void
 *****************************************************************************/
static void mmi_phnset_entry_set_language(MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    mmi_phnset_appcreate_menucui_create(
        parent_gid,
        GRP_ID_PHNSET_LANGUAGE,
        MENU_SETTING_LANGUAGE,
        mmi_phnset_language_menu_proc);
}


/*****************************************************************************
 * FUNCTION
 *  PhnsetLangLSKHandler
 * DESCRIPTION
 *  This function is left softkey handling function
 *  for Phonesetup->Language
 *  Functionality: Save the setting menu style
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
static void PhnsetLangLSKHandler(void)
{
#ifndef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U8 data;
    S32 LangIdx = g_phnset_cntx_p->curHightlightItem;
    BOOL isAutoLangSet = MMI_FALSE;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_AUTO_LANG_EN__
    if (g_phnset_cntx_p->curHightlightItem == 0)    /* Auto Language selected */
    {
        LangIdx = 0;
        isAutoLangSet = MMI_TRUE;
    }
    else
    {
        LangIdx -= 1;
    }
#endif /* __MMI_AUTO_LANG_EN__ */ 

    data = srv_setting_get_language();

   /************************************************************************/
    /* Robin 1129, Add auto language selection                        */
   /************************************************************************/
    /* if( (LangIdx != (S32) gCurrLangIndex) *** Different Language        */
    /*   || (data != 0xFF && isAutoLangSet == MMI_TRUE)  *** Auto Lang Set  */
    /*   || (data == 0xFF && isAutoLangSet == MMI_FALSE) *** Auto Lang UnSet */
    /*   )                                                   */
   /************************************************************************/
    if ((LangIdx != (S32) gCurrLangIndex)
        || (data != 0xFF && isAutoLangSet == MMI_TRUE) || (data == 0xFF && isAutoLangSet == MMI_FALSE))
    {
        if (isAutoLangSet == MMI_TRUE)
        {
        #ifdef __MMI_AUTO_LANG_EN__
            mmi_setting_set_language(AUTO_LANGUAGE_IDX);
        #endif /* __MMI_AUTO_LANG_EN__ */ 
        }
        else
        {
            mmi_setting_set_language(LangIdx);
        }
    }

#else
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U8 langSSC[SSC_SIZE];              
    U8 *langSSC_sel ;

    S32 LangIdx ;
    U8 langName[20];
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    strncpy(langName, (PU8)g_phnset_cntx_p->ppLang[g_phnset_cntx_p->curHightlightItem], 20);

    srv_setting_get_language(langSSC);
    mmi_li_get_ssc_by_langname(langName, (U8**)&langSSC_sel);
    LangIdx = GetLanguageIndex(langSSC_sel);

   /************************************************************************/
    /* Robin 1129, Add auto language selection                        */
   /************************************************************************/
    /* if( (LangIdx != (S32) gCurrLangIndex) *** Different Language        */
    /*   || (data != 0xFF && isAutoLangSet == MMI_TRUE)  *** Auto Lang Set  */
    /*   || (data == 0xFF && isAutoLangSet == MMI_FALSE) *** Auto Lang UnSet */
    /*   )                                                   */
   /************************************************************************/
    if (strcmp((PS8)gLanguageArray[LangIdx].aLangSSC, langSSC) != 0)
    {
            mmi_setting_set_language(LangIdx);
    }
#endif

    mmi_popup_display_simple_ext(STR_GLOBAL_DONE, MMI_EVENT_SUCCESS, GRP_ID_ROOT, NULL);
    mmi_frm_group_close(GRP_ID_PHNSET_LANGUAGE);
}
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif

/* Only for temporaly used */
/* Should be removed */
#ifndef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__
void SetCurrentLanguage(S8 nIndex)
{
    mmi_setting_set_language((U8)nIndex);
}
#else
void SetCurrentLanguage(U8* LangSSC)
{
    mmi_setting_set_language((U8)mmi_lang_support(LangSSC));
}
#endif

/*****************************************************************************
 * FUNCTION
 *  mmi_setting_set_language
 * DESCRIPTION
 *  Set system language by index of gLanguageArray 
 * PARAMETERS
 *  language_idx    :   [IN] index of language in gLanguageArray
 * RETURNS
 *  MMI_FALSE : system do not support this language
 *  MMI_TRUE  : the language is set successfully
 *****************************************************************************/
MMI_BOOL mmi_setting_set_language(U8 language_idx)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    #ifdef __MMI_AUTO_LANG_EN__
    U16 autoLangIdx;
        #endif /* __MMI_AUTO_LANG_EN__ */ 
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__ 
    srv_setting_set_language(gLanguageArray[language_idx].aLangSSC);
#else
    srv_setting_set_language(language_idx);
#endif

// TODO: implement notification receiver
    #ifdef __MMI_VUI_SHELL_MSG_VIEWER__
        vadp_shell_mv_refresh_panel();
    #endif

    if (mmi_idle_is_active())
    {
        mmi_idle_display();
    }
// TODO: implement notification receiver        
    
    return MMI_TRUE;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_get_language_idx
 * DESCRIPTION
 *  This function is to read language setting from nvram called by 
 *  Functionality:
 * PARAMETERS
 *  void           
 * RETURNS
 *  U8
 *****************************************************************************/
U8 mmi_phnset_get_language_idx(void)
{
#ifndef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__
	/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U8 data = srv_setting_get_language();

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
	if (data == 0xFF)
    {
    #ifdef __MMI_AUTO_LANG_EN__
        /* If read nvram before SIM LP comming, treat as unspecified language */
        /* PhonsetGetAugoLanIdx will return default language index */
        data = srv_setting_get_auto_language_id();
    #else /* __MMI_AUTO_LANG_EN__ */ 
		data = 0;
	#endif /* __MMI_AUTO_LANG_EN__ */
	}
	if (data == 0xFF)
	{
		return 0;
	}

	return data;
#else

    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U8 langSSC[SSC_SIZE];              
    U8 idx;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    srv_setting_get_language(langSSC);
    idx = (U8)GetLanguageIndex(langSSC);

    return idx;
#endif
}
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_language_menu
 * DESCRIPTION
 *  Init the language menu
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_init_language_menu(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    phnset_radio_button_menu_data_struct radio_button_menu;
    U8 nNumofItem;
    U8 hiliteItem = 0;
    U8 i;
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    nNumofItem = (S32) GetLanguages(&(g_phnset_cntx_p->ppLang));

#ifdef __MMI_AUTO_LANG_EN__
    {
        U8 data = srv_setting_get_language();
        if (data == 0xFF)   /* Auto Language set */
        {
            hiliteItem = 0;
        }
        else
        {
            hiliteItem += 1;
        }
    }
    subMenuDataPtrs[0] = (PU8) GetString(STR_GLOBAL_AUTOMATIC);
    for (i = 0; i < nNumofItem; i++)
    {
        subMenuDataPtrs[i + 1] = g_phnset_cntx_p->ppLang[i];
    }
    nNumofItem += 1;
#else /* __MMI_AUTO_LANG_EN__ */ 
    for (i = 0; i < nNumofItem; i++)
    {
        subMenuDataPtrs[i] = g_phnset_cntx_p->ppLang[i];

        if (strcmp((PS8)g_phnset_cntx_p->ppLang[i], (PS8)gLanguageArray[gCurrLangIndex].aName) == 0)
        {
               hiliteItem = i;
        }
    }
#endif /* __MMI_AUTO_LANG_EN__ */ 

    radio_button_menu.group_id = GRP_ID_PHNSET_LANGUAGE;
    radio_button_menu.menu_title_str_id = STR_MENU_LANGUAGE;
    radio_button_menu.menu_icon_id = MAIN_MENU_TITLE_SETTINGS_ICON;
    radio_button_menu.menu_item_num = nNumofItem;
    radio_button_menu.menu_item_str_list = subMenuDataPtrs;
    radio_button_menu.menu_item_str_id_list = NULL;
    radio_button_menu.highlighted_item_idx = hiliteItem;

    mmi_phnset_init_radio_button_menu(&radio_button_menu);
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_language_menu_proc
 * DESCRIPTION
 *  Proc function for language setting menu 
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  static mmi_ret
 *****************************************************************************/
static mmi_ret mmi_phnset_language_menu_proc(mmi_event_struct *param)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
 
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (param->evt_id)
    {
    case EVT_ID_CUI_MENU_LIST_ENTRY:
        mmi_phnset_init_language_menu();
        break;
    case EVT_ID_CUI_MENU_ITEM_SELECT:
    case EVT_ID_CUI_MENU_ITEM_TAP:
        g_phnset_cntx_p->curHightlightItem = (S32)((cui_menu_event_struct*)param)->highlighted_menu_id;
        PhnsetLangLSKHandler();
    	break;

    case EVT_ID_CUI_MENU_CLOSE_REQUEST:
        cui_menu_close(mmi_frm_group_get_active_id());
        break;
        
    case EVT_ID_GROUP_DEINIT:
        if (param->user_data)
    	{
    	    OslMfree(param->user_data);
    	}
        break;
        
    default:
    	break;
    }
    return MMI_RET_OK;    
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_language_menu_hint
 * DESCRIPTION
 *  Set hint for language setting menu 
 * PARAMETERS
 *  
 * RETURNS
 *  static void
 *****************************************************************************/
static void mmi_phnset_set_language_menu_hint(MMI_ID menucui_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    CHAR* hint_str;
#ifndef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__
    U8 data;
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    data = srv_setting_get_language();
#ifdef __MMI_AUTO_LANG_EN__
    if (data == 0xFF)   /* Auto Language Selected */
    {
        hint_str = (CHAR*)GetString(STR_GLOBAL_AUTOMATIC);
    }
    else
#endif /* __MMI_AUTO_LANG_EN__ */ 
    {
        hint_str = (CHAR*)gLanguageArray[data].aName;
    }
#else
    U8 langSSC[SSC_SIZE];
    U16 idx;
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    srv_setting_get_language(langSSC);

    idx = GetLanguageIndex(langSSC);

    hint_str = (CHAR*)gLanguageArray[idx].aName;

#endif
    cui_menu_set_item_hint(
        menucui_id,
        MENU_SETTING_LANGUAGE,
        (WCHAR*)hint_str);
} 

#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif
/*****************************************************************************
 * FUNCTION
 *  ATSetLanguage
 * DESCRIPTION
 *  Set Language from AT command
 * PARAMETERS
 *  msg     [?]     Set language request
 * RETURNS
 *  void
 *****************************************************************************/
#ifndef __MMI_PHNSET_AT_DISABLE__
static void ATSetLanguage(void *msg, int mod_id)
{
#ifndef __SLIM_AT__    
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    /* to see the value of language code */
    U8 data = 0;
    CHAR *ssc_sp;
    mmi_eq_set_language_req_ind_struct *msgInd;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    msgInd = (mmi_eq_set_language_req_ind_struct*) msg;

    switch (msgInd->lang_code)
    {
        case MMI_PS_AT_LANG_TW:
            ssc_sp = SSC_TCHINESE;  /* data = 1; */
            break;
        case MMI_PS_AT_LANG_ZH:
            ssc_sp = SSC_SCHINESE;  /* data = 2; */
            break;

        case MMI_PS_AT_LANG_DEFAULT:
        case MMI_PS_AT_LANG_EN:
        default:
            ssc_sp = SSC_ENGLISH;   /* data = 0; */
            break;
    }

    
        data = mmi_lang_support(ssc_sp);
            

    /* Language not support (out of boundary) */
    if (data >= gMaxDeployedLangs || data < 0)
    {
        SendLangChange2AT(0xFF, mod_id);
        return;
    }

    if (data != gCurrLangIndex)
    {
        mmi_setting_set_language(data);
    }

    SendLangChange2AT(data, mod_id);
#endif /* __SLIM_AT__ */
}

#ifndef __SLIM_AT__
/*****************************************************************************
 * FUNCTION
 *  SendLangChange2AT
 * DESCRIPTION
 *  Send to AT command when language change, for AT+CLAE
 * PARAMETERS
 *  code        [IN]        Language to be set
 * RETURNS
 *  void
 *****************************************************************************/
static void SendLangChange2AT(U8 code, int mod_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    mmi_eq_set_language_req_struct *msgReq;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    msgReq = (mmi_eq_set_language_req_struct*) OslConstructDataPtr(sizeof(mmi_eq_set_language_req_struct));

    /*
     * switch (code)
     * {
     * case 0: msgReq->lang_code = MMI_PS_AT_LANG_EN; break;
     * case 1: msgReq->lang_code = MMI_PS_AT_LANG_TW; break;
     * case 2: msgReq->lang_code = MMI_PS_AT_LANG_ZH; break;
     * default: msgReq->lang_code = MMI_PS_AT_LANG_EN; break;
     * }
     */

    if (code > gMaxDeployedLangs)
    {
        msgReq->lang_code = MMI_PS_AT_LANG_UNKWN;
    }
    else
    {
        if (mmi_lang_support(SSC_ENGLISH) >= 0)
        {
            msgReq->lang_code = MMI_PS_AT_LANG_EN;
        }
        else if (mmi_lang_support(SSC_TCHINESE) >= 0)
        {
            msgReq->lang_code = MMI_PS_AT_LANG_TW;
        }
        else if (mmi_lang_support(SSC_SCHINESE) >= 0)
        {
            msgReq->lang_code = MMI_PS_AT_LANG_ZH;
        }
        else
        {
            msgReq->lang_code = MMI_PS_AT_LANG_UNKWN;
        }
    }

    mmi_frm_send_ilm((oslModuleType)mod_id, PRT_MMI_EQ_SET_LANGUAGE_REQ, (oslParaType*)msgReq, NULL);
}
#endif /* __SLIM_AT__ */
#endif
#if 0
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
    #ifdef __OP01__
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
    #endif /* __OP01__ */
/* under construction !*/
    #ifdef MMI_ON_HARDWARE_P
/* under construction !*/
    #else 
/* under construction !*/
    #endif 
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#ifndef __MMI_VECTOR_FONT_MEMORY_CARD_SUPPORT__
/* under construction !*/
#endif
/* under construction !*/
/* under construction !*/
#endif /* __MMI_AUTO_LANG_EN__ */ 


/* UART Setup functions */
#ifdef __GEMINI__

#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif

#ifndef __MMI_PHNSET_AT_DISABLE__
static mmi_sim_enum g_uart_detach_sim;
static U8 g_uart_detach_sim_num;
static U8 g_uart_status = 0;
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_UART_setup_hint
 * DESCRIPTION
 *  Set hint for UART setup menu 
 * PARAMETERS
 *  
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_set_UART_setup_hint(MMI_ID menucui_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    #ifdef __MMI_PHNSET_SLIM__
    U16 hint_array[] = {
                       MMI_PHNSET_UART_SIM1
                      ,MMI_PHNSET_UART_SIM2
                      #if (MMI_MAX_SIM_NUM >= 3)
                      ,MMI_PHNSET_UART_SIM3
                      #if (MMI_MAX_SIM_NUM >= 4)
                      ,MMI_PHNSET_UART_SIM4
                      #endif
                      #endif
                      };
    S8 i=0;U16 k;
                         
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] mmi_phnset_set_UART_setup_hint(%d)", srv_setting_get_uart_setting());
    k=(U16)srv_setting_get_uart_setting();
    while(hint_array[i]==k)
     {
           
         if((++i)==(sizeof(hint_array)/sizeof(s16)))
          {
             i=0;
             break;
           }
     }
    cui_menu_set_item_hint(
             menucui_id,
             MENU_ID_PHNSET_UART_SETUP,
           (WCHAR*)GetString(STR_PHNSET_UART_1+i));
    #else
    CHAR* hint_str = NULL;
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] mmi_phnset_set_UART_setup_hint(%d)", srv_setting_get_uart_setting());
    switch (srv_setting_get_uart_setting())
    {
	case MMI_PHNSET_UART_SIM1:
		hint_str = (CHAR*) GetString(STR_PHNSET_UART_1);
		break;

	case MMI_PHNSET_UART_SIM2:
		hint_str = (CHAR*) GetString(STR_PHNSET_UART_2);
		break;
    #if (MMI_MAX_SIM_NUM >= 3)
	case MMI_PHNSET_UART_SIM3:
		hint_str = (CHAR*) GetString(STR_PHNSET_UART_3);
		break;
    #if (MMI_MAX_SIM_NUM >= 4)
	case MMI_PHNSET_UART_SIM4:
		hint_str = (CHAR*) GetString(STR_PHNSET_UART_4);
		break;
    #endif /* (MMI_MAX_SIM_NUM >= 4) */
    #endif /* (MMI_MAX_SIM_NUM >= 3) */

	default:
		hint_str = (CHAR*) GetString(STR_PHNSET_UART_1);
		break;
    }
    cui_menu_set_item_hint(
        menucui_id,
        MENU_ID_PHNSET_UART_SETUP,
        (WCHAR*)hint_str);
    #endif
}


/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetUARTSetup
 * DESCRIPTION
 *  This function to Entry UART Setup
 * PARAMETERS
 *  void            
 * RETURNS
 *  void
 *****************************************************************************/
static void EntryPhnsetUARTSetup(MMI_ID parent_gid)
{
/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
	
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_BACKGROUND_CALL__
    if (srv_ucm_is_background_call())
    {
        mmi_ucm_app_entry_error_message();

        return;
    }
#endif /* __MMI_BACKGROUND_CALL__ */
	
        mmi_phnset_appcreate_menucui_create(
        parent_gid,
        GRP_ID_PHNSET_UART_SETUP,
        MENU_ID_PHNSET_UART_SETUP,
        mmi_phnset_UART_proc);
}

/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_UART_proc
 * DESCRIPTION
 *  Menu CUI proc function formmi_phnset_UART 
 * PARAMETERS
 *  
 * RETURNS
 *  mmi_ret
 *****************************************************************************/
mmi_ret mmi_phnset_UART_proc(mmi_event_struct *param)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
 
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (param->evt_id)
    {
    case EVT_ID_CUI_MENU_LIST_ENTRY:
        mmi_phnset_init_UART_list();
        break;

    case EVT_ID_CUI_MENU_ITEM_SELECT:
    case EVT_ID_CUI_MENU_ITEM_TAP:
        mmi_phnset_set_uart((U16)((cui_menu_event_struct*)param)->highlighted_menu_id);
        break;
        
    case EVT_ID_CUI_MENU_CLOSE_REQUEST:
        cui_menu_close(mmi_frm_group_get_active_id());
        break;
        
    case EVT_ID_GROUP_DEINIT:
        if (param->user_data)
    	{
    	    OslMfree(param->user_data);
    	}
        break;
   
   case EVT_ID_ALERT_QUIT:
   {
	   mmi_alert_result_evt_struct *confirm_evt = (mmi_alert_result_evt_struct*)param;
	   switch (confirm_evt->result)
	   {
	   case MMI_ALERT_CNFM_YES:
		   mmi_phnset_UART_setup_confirm();
		   break;
		   
	   case MMI_ALERT_CNFM_NO:		   
		   mmi_frm_group_close(GRP_ID_PHNSET_UART_SETUP);
		   break;
		   
	   default:
		   break;
	   }
	   return MMI_RET_OK;  
   }		
    default:
		break;
    }
    return MMI_RET_OK;
}
 

/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_UART_list
 * DESCRIPTION
 *  Initialize UART setup menu list 
 * PARAMETERS
 *  void
 * RETURNS
 *  static void
 *****************************************************************************/
static void mmi_phnset_init_UART_list(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    phnset_radio_button_menu_data_struct radio_button_menu;
	U16 nStrItemList[] = {
        STR_PHNSET_UART_1 
        ,STR_PHNSET_UART_2
    #if (MMI_MAX_SIM_NUM >= 3)
        ,STR_PHNSET_UART_3
    #if (MMI_MAX_SIM_NUM >= 4)
        ,STR_PHNSET_UART_4
    #endif
    #endif
        };    
    U16 nNumofItem;    
    U8 highlight_item = srv_setting_get_uart_setting();
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] mmi_phnset_init_UART_list(%d)", highlight_item);    
    nNumofItem = 2;
    #if (MMI_MAX_SIM_NUM == 3)
    nNumofItem = 3;
    #endif /* (MMI_MAX_SIM_NUM == 3) */
    #if (MMI_MAX_SIM_NUM == 4)
    nNumofItem = 4;
    #endif /* (MMI_MAX_SIM_NUM == 4) */

    radio_button_menu.group_id = GRP_ID_PHNSET_UART_SETUP;
    radio_button_menu.menu_title_str_id = STR_ID_PHNSET_UART_SETUP_TITLE;
    radio_button_menu.menu_icon_id = MAIN_MENU_TITLE_SETTINGS_ICON;
    radio_button_menu.menu_item_num = nNumofItem;
    radio_button_menu.menu_item_str_list = NULL;
    radio_button_menu.menu_item_str_id_list = nStrItemList;
    radio_button_menu.highlighted_item_idx = highlight_item;

    mmi_phnset_init_radio_button_menu(&radio_button_menu);    
}

static void mmi_phnset_UART_setup_confirm(void)
{
	srv_setting_set_primary_card(mmi_frm_index_to_sim(g_uart_status));

	mmi_phnset_UART_setup_reboot_prcessing();
    g_uart_detach_sim = MMI_SIM1;
    g_uart_detach_sim_num = 1;
	mmi_phnset_UART_setup_reboot_req();

}

/*****************************************************************************
 * FUNCTION
 *  PhnSetUARTSetupReboot
 * DESCRIPTION
 *  This function call alarm reboot API to reboot mobile
 * PARAMETERS
 *  void          
 * RETURNS
 *  void
 *****************************************************************************/
static void  mmi_phnset_UART_setup_reboot(void)
{
	/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
	
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] PhnSetUARTSetupReboot()");
	
    AlmATPowerReset(MMI_FALSE, 3); /* shutdown system and reboot in 3 seconds. */
}

/*****************************************************************************
 * FUNCTION
 *  PhnSetUARTSetupReboot
 * DESCRIPTION
 *  This function is to reboot mobile
 * PARAMETERS
 *  void          
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_UART_setup_reboot_req(void)
{
	/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    MYQUEUE Message;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    ClearProtocolEventHandler(MSG_ID_MMI_NW_PWROFF_DETACH_RSP);
	SetProtocolEventHandler(mmi_phnset_UART_setup_reboot_rsp, MSG_ID_MMI_NW_PWROFF_DETACH_RSP);
    switch (g_uart_detach_sim)
	{
	case MMI_SIM1:
        Message.oslDestId = MOD_L4C;		
		break;
	case MMI_SIM2:
        Message.oslDestId = MOD_L4C_2;		
		break;        

	
	#if (GEMINI_PLUS >= 3)		  
	case MMI_SIM3:
        Message.oslDestId = MOD_L4C_3;		
		break;    

	#if (GEMINI_PLUS >= 4)		  
	case MMI_SIM4:
        Message.oslDestId = MOD_L4C_4;		
		break;        
	#endif /* (GEMINI_PLUS >= 4) */
	#endif /* (GEMINI_PLUS >= 3) */ 		  
	default:
        ASSERT(0);		
	}

    /* Detach network */
    mmi_frm_send_ilm(Message.oslDestId, MSG_ID_MMI_NW_PWROFF_DETACH_REQ, NULL, NULL);
}


/*****************************************************************************
 * FUNCTION
 *  PhnSetUARTSetupRebootRsp
 * DESCRIPTION
 *  This function is to reboot mobile response
 * PARAMETERS
 *  void          
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_UART_setup_reboot_rsp(void *msg)
{
	/*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] PhnSetUARTSetupRebootRsp(%d)", g_uart_detach_sim);    
    ClearProtocolEventHandler(MSG_ID_MMI_NW_PWROFF_DETACH_RSP);

    if (g_uart_detach_sim_num == MMI_SIM_TOTAL)
	{
        mmi_phnset_UART_setup_reboot();
        return;
	}
    g_uart_detach_sim_num++;
    
    switch (g_uart_detach_sim)
	{
	case MMI_SIM1:
        g_uart_detach_sim = MMI_SIM2;		
		break;

    #if (GEMINI_PLUS >= 3)            
	case MMI_SIM2:
        g_uart_detach_sim = MMI_SIM3;		
		break;        

    #if (GEMINI_PLUS >= 4)             
	case MMI_SIM3:
        g_uart_detach_sim = MMI_SIM4;		
		break;    
    #endif /* (GEMINI_PLUS >= 4) */
    #endif /* (GEMINI_PLUS >= 3) */          

	default:
        ASSERT(0);		
	}    
    mmi_phnset_UART_setup_reboot_req();
}


/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetUARTSetupRebootProcessing
 * DESCRIPTION
 *  This function is display reboot processing
 * PARAMETERS
 *  void          
 * RETURNS
 *  void
 *****************************************************************************/

static void mmi_phnset_UART_setup_reboot_prcessing(void)
{
	ChangeLeftSoftkey(0, 0);
    ChangeRightSoftkey(0, 0);
	
    mmi_frm_scrn_enter(
        GRP_ID_PHNSET_UART_SETUP, 
        SCR_ID_PHNSET_UART_REBOOT_PROCESSING,
        NULL,
        mmi_phnset_UART_setup_reboot_prcessing,
        MMI_FRM_UNKNOW_SCRN);
	
    ShowCategory66Screen(
        STR_ID_PHNSET_UART_SETUP_TITLE,
        GetRootTitleIcon(MENU_ID_PHNSET_UART_SETUP),
        0,
        0,
        0,
        0,
        (PU8) GetString(STR_ID_PHNSET_UART_SETUP_REBOOT_PROCESSING),
        mmi_get_event_based_image(MMI_EVENT_PROGRESS),
        NULL);
	
    ClearInputEventHandler(MMI_DEVICE_ALL);
    SetKeyHandler(MMI_dummy_function, KEY_END, KEY_EVENT_UP);
    SetKeyHandler(MMI_dummy_function, KEY_END, KEY_EVENT_DOWN);
    SetKeyHandler(MMI_dummy_function, KEY_END, KEY_LONG_PRESS);
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_uart
 * DESCRIPTION
 *  This function to Entry UART Setup
 * PARAMETERS
 *  void            
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_set_uart(U16 select_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    mmi_confirm_property_struct confirm_arg;
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
#ifdef __MMI_BACKGROUND_CALL__
    if (srv_ucm_is_background_call())
    {
		mmi_ucm_app_entry_error_message();
        
        return;
    }
#endif /* __MMI_BACKGROUND_CALL__ */
	g_uart_status = select_id;
    MMI_PRINT(MOD_MMI_COMMON_APP, MMI_COMMON_TRC_G7_SETTING, "[PhoneSetup.c] mmi_phnset_set_uart(%d, %d)", srv_setting_get_uart_setting(), g_phnset_cntx_p->curHightlightItem);
    if (srv_setting_get_uart_setting() == select_id)
    {
	mmi_popup_display_simple_ext(
            STR_GLOBAL_DONE,
            MMI_EVENT_SUCCESS,
            GRP_ID_ROOT,
            NULL);

        mmi_frm_group_close(GRP_ID_PHNSET_UART_SETUP);

		return;
	}
    
	mmi_confirm_property_init(&confirm_arg, CNFM_TYPE_YESNO);
	confirm_arg.callback = NULL;
	confirm_arg.parent_id = GRP_ID_PHNSET_UART_SETUP;
	mmi_confirm_display(
		(WCHAR*)get_string(STR_ID_PHNSET_UART_REBOOT),
		MMI_EVENT_QUERY,
		&confirm_arg);		  

}
#endif
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif
/*****************************************************************************
 * FUNCTION
 *  PhnsetSetUARTConfig
 * DESCRIPTION
 *  This function is to set UART config to mobile
 * PARAMETERS
 *  rmmi_sim_uart_setting_enum   UART config        
 * RETURNS
 *  void
 *****************************************************************************/
void PhnsetSetUARTConfig(rmmi_sim_uart_setting_enum uart_config)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    // Only used by MMI_task
    srv_setting_set_uart_setting(uart_config);
}


/*****************************************************************************
 * FUNCTION
 *  PhnsetGetUARTConfig
 * DESCRIPTION
 *  This function is to get UART config
 * PARAMETERS
 *  void          
 * RETURNS
 *  void
 *****************************************************************************/
rmmi_sim_uart_setting_enum PhnsetGetUARTConfig(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    return srv_setting_get_uart_setting();
}


#endif	/* __GEMINI__ */
////xjdan need move to date and time
/*****************************************************************************
 * FUNCTION
 *  PhnsetReinitHomeCityIdx
 * DESCRIPTION
 *  This function is to rearrange home city global array and set home city highlight item
 *  Functionality:
 * PARAMETERS
 *  void
 *  a(?)        [IN/OUT]        
 *  b(?)        [IN]            
 * RETURNS
 *  void
 *****************************************************************************/
void PhnsetReinitHomeCityIdx(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
     /**
        * This Is Needed As Set Home City NVRAM Index Doesnt Change On Language Change
      * As The Global City Array Is Chnaged. 
      **/

     /**************************************************************/
    /*  Dont Chnage Order Of These Function Calls --Start-- Gurinder   ***** */
    #ifdef __MMI_TIMEZONE_SETTING__
    PhnsetReadNvmHomeCityIdxNStoreCityName();
    PhnsetReinitHomeCity();
    #endif 
    /*  Dont Chnage Order Of These Function Calls --End-- Gurinder     ***** */
     /**************************************************************/
}


/*****************************************************************************
 * FUNCTION
 *  PhnsetGetFontSize
 * DESCRIPTION
 *  ...
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
U8 PhnsetGetFontSize(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    #ifdef __MMI_CHANGABLE_FONT__
    return g_phnset_cntx_p->font_size;
    #else
    return THEME_DEFAULT;
    #endif /* __MMI_CHANGABLE_FONT__ */
}

#ifdef __MMI_CHANGABLE_FONT__
/*****************************************************************************
 * FUNCTION
 *  PhnsetReadFontSize
 * DESCRIPTION
 *  ...
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void PhnsetReadFontSize(void)   /* __USB_IN_NORMAL_MODE__ */
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    //S16 error;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    //ReadValue(NVRAM_BYTE_FONT_SIZE, &(g_phnset_cntx_p->font_size), DS_BYTE, &error);
	ReadValueSlim(NVRAM_BYTE_FONT_SIZE, &(g_phnset_cntx_p->font_size), DS_BYTE);
    if (g_phnset_cntx_p->font_size > LARGE)
    {
        g_phnset_cntx_p->font_size = THEME_DEFAULT;
    }

}


/*****************************************************************************
 * FUNCTION
 *  PhnsetSetFontSize
 * DESCRIPTION
 *  Setting Font Size Enum
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void PhnsetSetFontSize(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    //S16 error = 0;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    //WriteValue(NVRAM_BYTE_FONT_SIZE, &(g_phnset_cntx_p->font_size), DS_BYTE, &error);
	WriteValueSlim(NVRAM_BYTE_FONT_SIZE, &(g_phnset_cntx_p->font_size), DS_BYTE);
    change_font_Theme();

	mmi_popup_display_simple_ext(STR_GLOBAL_DONE, MMI_EVENT_SUCCESS, GRP_ID_ROOT, NULL);
    mmi_frm_group_close(GRP_ID_PHNSET_FONT_SIZE);
}


/*****************************************************************************
 * FUNCTION
 *  EntryPhnsetFontSize
 * DESCRIPTION
 *  
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
void EntryPhnsetFontSize(MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
        mmi_phnset_appcreate_menucui_create(
        parent_gid,
        GRP_ID_PHNSET_FONT_SIZE,
        MENU_ID_PHNSET_FONT_SIZE,
        mmi_phnset_font_size_proc);
}

/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_font_size_proc
 * DESCRIPTION
 *  Menu CUI proc function formmi_phnset_font_size 
 * PARAMETERS
 *  
 * RETURNS
 *  mmi_ret
 *****************************************************************************/
mmi_ret mmi_phnset_font_size_proc(mmi_event_struct *param)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
 
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (param->evt_id)
    {
    case EVT_ID_CUI_MENU_LIST_ENTRY:
        mmi_phnset_init_font_size_list();
        break;
    case EVT_ID_CUI_MENU_ITEM_SELECT:
    case EVT_ID_CUI_MENU_ITEM_TAP:        
        g_phnset_cntx_p->font_size = (U8)((cui_menu_event_struct*)param)->highlighted_menu_id;
        PhnsetSetFontSize();
        break;

    case EVT_ID_CUI_MENU_CLOSE_REQUEST:
        cui_menu_close(mmi_frm_group_get_active_id());
        break;
        
    case EVT_ID_GROUP_DEINIT:
        if (param->user_data)
    	{
    	    OslMfree(param->user_data);
    	}
        break;
    default:

    }
    return MMI_RET_OK;
}

 
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_font_size_list
 * DESCRIPTION
 *  Initialize font size setting list menu 
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_init_font_size_list(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
#ifndef __MMI_DIALLING_FONT__
    U8 nNumofItem = 4;
    U16 nStrItemList[4] = 
    {
        STR_ID_PHNSET_FONT_SIZE_THEME_DEFAULT, STR_ID_PHNSET_FONT_SIZE_SMALL, STR_GLOBAL_MEDIUM,
        STR_ID_PHNSET_FONT_SIZE_LARGE
    };
#else /* __MMI_DIALLING_FONT__ */ 
    U8 nNumofItem = 3;
    U16 nStrItemList[3] = 
    {
        STR_ID_PHNSET_FONT_SIZE_THEME_DEFAULT, STR_ID_PHNSET_FONT_SIZE_SMALL, STR_GLOBAL_MEDIUM
    };
#endif /* __MMI_DIALLING_FONT__ */      
    phnset_radio_button_menu_data_struct radio_button_menu;
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    radio_button_menu.group_id = GRP_ID_PHNSET_FONT_SIZE;
    radio_button_menu.menu_title_str_id = STR_ID_PHNSET_FONT_SIZE;
    radio_button_menu.menu_icon_id = MAIN_MENU_TITLE_SETTINGS_ICON;
    radio_button_menu.menu_item_num = nNumofItem;
    radio_button_menu.menu_item_str_list = NULL;
    radio_button_menu.menu_item_str_id_list = nStrItemList;
    radio_button_menu.highlighted_item_idx = g_phnset_cntx_p->font_size;

    mmi_phnset_init_radio_button_menu(&radio_button_menu);    
}
 

/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_set_font_size_hint
 * DESCRIPTION
 *  Set hint for font size setting menu 
 * PARAMETERS
 *  
 * RETURNS
 *  void
 *****************************************************************************/
static void mmi_phnset_set_font_size_hint(MMI_ID menucui_id)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    CHAR* hint_str;
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (g_phnset_cntx_p->font_size)
    {
        case THEME_DEFAULT:
            hint_str = (CHAR*)GetString(STR_ID_PHNSET_FONT_SIZE_THEME_DEFAULT);
            break;
        case SMALL:
            hint_str = (CHAR*)GetString(STR_ID_PHNSET_FONT_SIZE_SMALL);
            break;
        case MEDIUM:
            hint_str = (CHAR*)GetString(STR_GLOBAL_MEDIUM);
            break;
        case LARGE:
            hint_str = (CHAR*)GetString(STR_ID_PHNSET_FONT_SIZE_LARGE);            
            break;
    }
    cui_menu_set_item_hint(
        menucui_id,
        MENU_ID_PHNSET_FONT_SIZE,
        (WCHAR*)hint_str);
}
#endif /* __MMI_CHANGABLE_FONT__ */ 
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata = "DYNAMIC_CODE_SETTINGS_RODATA" , code = "DYNAMIC_CODE_SETTINGS_ROCODE"
#endif
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_menu_handler
 * DESCRIPTION
 *  proc function for GRP_ID_PHNSET_MENU
 * PARAMETERS
 *  param : [IN]    post event
 * RETURNS
 *  process result
 *****************************************************************************/
typedef mmi_ret (*mmi_phnset_menu_entry_hdlr) (cui_menu_event_struct *param, MMI_ID parent_gid);
mmi_phnset_menu_entry_hdlr phnset_menu_entry_array[]={
       mmi_phnset_main_menu_handler
#ifndef __MMI_MAINLCD_96X64__        
       ,mmi_phnset_disp_setup_sub_menu_handler
       ,mmi_phnset_time_and_date_sub_menu_handler
#endif       
       #ifdef __MMI_NITZ__
       ,mmi_nitz_phnset_menu_handler
       #endif
       #ifdef __NTPD_SUPPORT__
       ,mmi_ntp_phnset_menu_handler
       #endif
       #if defined(__MMI_MIXED_LANG_SUPPORT__) || defined(__MMI_PREFER_WRITING_LANG__) || defined(__MMI_PREFER_INPUT_METHOD__) || defined(__MMI_IME_PLUG_IN_SETTING__)
       ,mmi_imesettings_menu_handler
       #endif
       #if defined (__MMI_IME_V3__)
       ,mmi_imesettings_menu_handler_ext
       #endif
       #if defined(__MMI_FE_VECTOR_FONT_ON_FILE_SYSTEM__)
       ,mmi_font_mgr_menu_handler
       #endif
       #if defined(__MMI_GADGET_SUPPORT__)
       ,mmi_wgtmgr_menu_handler
       #endif
       #ifdef __MMI_THEMES_APPLICATION__
       ,mmi_theme_menu_handler
       #endif
       #ifndef __DISABLE_SHORTCUTS_MENU__
       ,mmi_shct_menu_handler
       #ifdef __MMI_DEDICATED_KEY_SHORTCUTS__
       ,mmi_shct_dedicated_key_menu_handler
       #endif
       #endif
	   #ifndef __MMI_MAINLCD_96X64__
       ,mmi_phnset_gpio_menu_handler
       #endif
       ,NULL
       
    };
static mmi_ret mmi_phnset_menu_handler(mmi_event_struct *param)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    cui_menu_event_struct *menucui_event;
    mmi_ret ret = MMI_RET_DONT_CARE;
    S8 i=0;

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* Menu CUI event */
    if (cui_menu_is_menu_event(param->evt_id))
    {
        menucui_event = (cui_menu_event_struct*)param;
       while(1)
        {
         if(phnset_menu_entry_array[i])
         {
              ret=phnset_menu_entry_array[i](menucui_event, GRP_ID_PHNSET_MENU);
              if (ret != MMI_RET_DONT_CARE)
              {
               return ret;
              }
         }
         else
         {
            return ret;
         }
           i++;
        }
           
    }
	return MMI_RET_OK;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_main_menu_handler
 * DESCRIPTION
 *  proc function for menu cui in GRP_ID_PHNSET_MENU
 * PARAMETERS
 *  param : [IN]    menu cui event
 * RETURNS
 *  process result
 *****************************************************************************/
static mmi_ret mmi_phnset_main_menu_handler(cui_menu_event_struct *param, MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    switch (param->evt_id)
    {
    case EVT_ID_CUI_MENU_LIST_ENTRY:
        return mmi_phnset_main_menu_entry_handler(param, parent_gid);
#ifndef __MMI_PHNSET_SLIM__    

    case EVT_ID_CUI_MENU_ITEM_HILITE:
        return mmi_phnset_main_menu_highlight_handler(param, parent_gid);
#endif
    case EVT_ID_CUI_MENU_ITEM_SELECT:
    case EVT_ID_CUI_MENU_ITEM_TAP:
        return mmi_phnset_main_menu_select_handler(param, parent_gid);

    case EVT_ID_CUI_MENU_CLOSE_REQUEST:
        return mmi_phnset_main_menu_close_handler(param, parent_gid);
       
    default:
        break;            
    }
    return MMI_RET_DONT_CARE;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_main_menu_entry_handler
 * DESCRIPTION
 *  Entry proc for phone setup menu
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  mmi_ret
 *****************************************************************************/
static mmi_ret mmi_phnset_main_menu_entry_handler(cui_menu_event_struct *param, MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/  
    switch (param->parent_menu_id)
    {
    case MENU9102_INITIAL_SETUP:
        mmi_phnset_init_main_menu();
        return MMI_RET_OK;
    case MENU_ID_PHNSET_GPIO_SETTING:
        cui_menu_set_currlist_left_softkey_by_id(param->sender_id, STR_GLOBAL_OK);
        cui_menu_set_currlist_right_softkey_by_id(param->sender_id, STR_GLOBAL_BACK); 
        break;
    default:
        break;
    }
    return MMI_RET_DONT_CARE;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_main_menu_highlight_handler
 * DESCRIPTION
 *  Highlight funciton for phone setup menu
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  mmi_ret 
 *****************************************************************************/
#ifndef __MMI_PHNSET_SLIM__    
static mmi_ret mmi_phnset_main_menu_highlight_handler(cui_menu_event_struct *param, MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/    
    switch (param->highlighted_menu_id)
    {
    default:
        /* In order to set lsk back to OK */
        cui_menu_change_left_softkey_string_by_id(mmi_frm_group_get_active_id(), STR_GLOBAL_OK);
        break;
    }
    return MMI_RET_DONT_CARE;    
}
#endif

/*****************************************************************************
 * FUNCTION
 *  
 * DESCRIPTION
 *  Select funciton for phone setup menu 
 *  (divied into main menu select proc and sub menu select proc)
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  mmi_ret
 *****************************************************************************/
static mmi_ret mmi_phnset_main_menu_select_handler(cui_menu_event_struct *param, MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/    
    switch (param->highlighted_menu_id)
    {
#ifdef __MMI_PHNSET_SCHEDULE_POWER_ON_OFF__
    case MENU_SETTING_SCHEDULE_POWER:
        EntrySpofApp(parent_gid);
        return MMI_RET_OK;        
#endif
       
#if defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__) 
	#if !defined(__MMI_IME_V3__)
		case MENU_SETTING_HANDWRITING:
		EntryHandWritingSettingScr(parent_gid);
		return MMI_RET_OK;  
	#endif
#endif

    case MENU_SETTING_LANGUAGE:
        mmi_phnset_entry_set_language(parent_gid);
        return MMI_RET_OK;        
        
#ifdef __MMI_SET_DEF_ENCODING_TYPE__        
    case MENU_SETTING_DEF_ENCODING_TYPE:
        EntryPhnsetDefEncoding(parent_gid);
        return MMI_RET_OK;        
#endif /* __MMI_SET_DEF_ENCODING_TYPE__  */      
#if defined(__FLIGHT_MODE_SUPPORT__) && defined(__MMI_TELEPHONY_SUPPORT__)
    case MENU_SETTING_FLIGHT_MODE:
        mmi_flight_mode_entry(parent_gid);
        return MMI_RET_OK;        
#endif /* __FLIGHT_MODE_SUPPORT__ */

#ifdef __MMI_CHANGABLE_FONT__
    case MENU_ID_PHNSET_FONT_SIZE:
        EntryPhnsetFontSize(parent_gid);
        return MMI_RET_OK;        
#endif 

#ifdef __MMI_DUAL_SIM_MASTER__
#ifndef __MMI_PHNSET_AT_DISABLE__
/* under construction !*/
#ifdef __MTK_TARGET__
/* under construction !*/
#else 
/* under construction !*/
#endif         
/* under construction !*/
#endif        
#endif /* __MMI_DUAL_SIM_MASTER__ */
#ifdef __GENERAL_TTS__
    case MENU_ID_PHB_TTS_SETTING:
        mmi_tts_setting_entry_call_tts_setting(parent_gid);
        return MMI_RET_OK;

    case MENU_ID_SMS_TTS_SETTING:
        mmi_tts_setting_entry_sms_tts_setting(parent_gid);
        return MMI_RET_OK;        
#endif /* __GENERAL_TTS__ */

#ifdef MOTION_SENSOR_SUPPORT
    case MENU_ID_MOTION:/*cmm test*/
        mmi_phone_setting_motion_entry();
        break;
#endif

#ifdef __MMI_VUI_LAUNCHER_KEY__
	case MENU_ID_KEY_LAUNGCHER_WGTMGR:
		mmi_phnset_widget_manager_launch(parent_gid);
		return MMI_RET_OK;
#endif

#ifdef __MMI_VUI_LAUNCHER_KEY__
	case MENU_ID_FTE_LAUNGCHER_SHORTCUT:
		mmi_phnset_shortcut_mananger_launch(parent_gid);
		return MMI_RET_OK;
#endif

#ifdef __GENERAL_TTS__
	case MENU_ID_CUI_DIALER_TTS:
		cui_dialer_entry_tts_setting();
		return MMI_RET_OK;
#endif
    default:
        break;
    }
    return MMI_RET_DONT_CARE;
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_main_menu_close_handler
 * DESCRIPTION
 *  Close funciton for phone setup menu
 * PARAMETERS
 *  param   [IN]
 * RETURNS
 *  mmi_ret 
 *****************************************************************************/
static mmi_ret mmi_phnset_main_menu_close_handler(cui_menu_event_struct *param, MMI_ID parent_gid)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/    
    cui_menu_close(mmi_frm_group_get_active_id());
    return MMI_RET_OK;    
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_main_menu
 * DESCRIPTION
 *  Init main menu of phone setup
 * PARAMETERS
 *  void
 * RETURNS
 *  void
 *****************************************************************************/
extern void mmi_phnset_hide_menu_ext(MMI_ID main_menu_cui_id,const mmi_setting_hide_menu_struct* hide_menu_struct);
static void mmi_phnset_init_main_menu(void)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
   // U16 i;
    MMI_ID main_menu_cui_id = mmi_frm_group_get_active_id();

    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* Hide menu item */
#if 0  
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
/* under construction !*/
#endif

   mmi_phnset_hide_menu_ext(main_menu_cui_id,mmi_phnset_hide_menu);
#ifdef __MMI_TELEPHONY_SUPPORT__
    if (srv_cphs_is_service_available(SRV_CPHS_GROUP_VALUE_ADDED_SERVICES, SRV_CPHS_SERVICE_LANGUAGE, MMI_SIM1)
#ifdef __MMI_DUAL_SIM_MASTER__           
/* under construction !*/
#endif
        )
	{
	    cui_menu_set_item_hidden(main_menu_cui_id, MENU_SETTING_LANGUAGE, MMI_FALSE);
	}
    else
    {
	    cui_menu_set_item_hidden(main_menu_cui_id, MENU_SETTING_LANGUAGE, MMI_TRUE);
    }
#endif

#if defined(__MMI_TOUCH_SCREEN__) && !defined(__MMI_NO_HANDWRITING__) && !defined(__MMI_IME_V3__)
#if defined(__MMI_HANDWRITING_MEMORY_CARD_SUPPORT__)
	if(!mmi_imm_get_handwriting_setting())
	{
	    MMI_TRACE(MMI_FW_TRC_G5_IME, TRC_MMI_PHNSET_INIT_MAIN_MENU);
        cui_menu_set_item_hidden(main_menu_cui_id, MENU_SETTING_HANDWRITING, MMI_TRUE);
	}
#endif
#endif
#ifdef __MMI_BTD_BOX_UI_STYLE__
#ifdef __MMI_PREFER_INPUT_METHOD__
   cui_menu_set_item_hidden(main_menu_cui_id, MENU_SETTING_PREFERED_INPUT_METHOD, MMI_TRUE);
#endif/*__MMI_PREFER_INPUT_METHOD__*/
#endif/*__MMI_BTD_BOX_UI_STYLE__*/

    /* set menu list flags to numbered icon menu list at the first time enter*/
    cui_menu_set_currlist_flags(main_menu_cui_id, CUI_MENU_NORMAL_LIST_WITH_NUMBERED_ICONS);

    /* set hints of menu item */
    mmi_phnset_set_language_menu_hint(main_menu_cui_id);
#ifdef __MMI_PREFER_INPUT_METHOD__
	mmi_phnset_set_pref_input_mode_menu_hint(main_menu_cui_id);
#endif
#ifdef __MMI_SET_DEF_ENCODING_TYPE__ 
    mmi_phnset_set_encoding_menu_hint(main_menu_cui_id);
#endif
#ifdef __MMI_CHANGABLE_FONT__
    mmi_phnset_set_font_size_hint(main_menu_cui_id);
#endif
#ifdef __MMI_DUAL_SIM_MASTER__
#ifndef __MMI_PHNSET_AT_DISABLE__
/* under construction !*/
#endif
#endif
#ifndef __MMI_DUAL_SIM_MASTER__   
  #ifdef __MMI_TELEPHONY_SUPPORT__
    HintPhnsetFlightMode();
#endif
#endif
#ifdef __MMI_NITZ__
    mmi_phnset_set_nitz_text_hint(main_menu_cui_id);
#endif
    cui_menu_set_currlist_left_softkey_by_id(main_menu_cui_id, STR_GLOBAL_OK);
    cui_menu_set_currlist_right_softkey_by_id(main_menu_cui_id, STR_GLOBAL_BACK);    
#ifdef __MMI_VUI_LAUNCHER_KEY__
	if(vapp_keylauncher_get_widget_total_num() <= MIN_PHNSET_WIDGETS_NUM)
	{
		cui_menu_set_item_string_by_id(main_menu_cui_id, MENU_ID_KEY_LAUNGCHER_WGTMGR, STR_ID_KEY_LAUNGCHER_WGTMGR_ORDER_SETTINGS); 
	}
#endif

    /* cui_menu_refresh_currlist(main_menu_cui_id); */

}
#ifdef __MMI_AP_DCM_SETTING__
#pragma arm section rodata , code
#endif
/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_appcreate_menucui_create
 * DESCRIPTION
 *  Create a app create menu cui for menu under phone setting. The group will 
 *  be closed if the input group id already exist. parent id, new group id, 
 *  menu cui id will be saved in user data.
 *
 *  Remember to free the memory in proc function
 *
 * PARAMETERS
 *  group_id    [IN]    new group id to be created
 *  proc        [IN]    proc function assigned to the new group
 *  menu_id     [IN]    menu id the menu cui assigned to
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_phnset_appcreate_menucui_create(MMI_ID parent_gid, MMI_ID group_id, U16 menu_id, mmi_proc_func proc)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/

    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    
    if(mmi_phnset_entry_group_check_ex(parent_gid,group_id))
        return;
	mmi_frm_group_create_ex(
		parent_gid,
        group_id,
        proc,
        NULL,
		MMI_FRM_NODE_SMART_CLOSE_FLAG);
	cui_menu_create_and_run(
		group_id,
        CUI_MENU_SRC_TYPE_APPCREATE,
        CUI_MENU_TYPE_APPMAIN,
        menu_id,
        MMI_FALSE,
        NULL);   
    
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_radio_button_menu
 * DESCRIPTION
 *  Initialize the radio button menu list for menu under phone setting 
 * PARAMETERS
 *  
 * RETURNS
 *  void
 *****************************************************************************/
void mmi_phnset_init_radio_button_menu(phnset_radio_button_menu_data_struct *menu_data)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U16 nNumofItem = menu_data->menu_item_num; 
    U8 i;
    U8 highlight_item = menu_data->highlighted_item_idx;
    mmi_menu_id *menu_id;
    MMI_ID menu_cui_id = mmi_frm_group_get_active_id();
    
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    /* Dynamically create a menu id list */
    menu_id = (mmi_menu_id*)OslMalloc(nNumofItem * sizeof(mmi_menu_id));
    for(i = 0; i < nNumofItem; i++)
    {
        menu_id[i]=(mmi_menu_id)i;
    }
    
    cui_menu_set_currlist_title_by_id(menu_cui_id, menu_data->menu_title_str_id, menu_data->menu_icon_id);
    
    cui_menu_set_currlist(menu_cui_id, nNumofItem, menu_id);
    
    cui_menu_set_currlist_flags(menu_cui_id, CUI_MENU_NORMAL_RADIO_BUTTON_LIST);

    if (!mmi_frm_is_in_backward_scenario())
	{
            cui_menu_set_currlist_highlighted_id(menu_cui_id, highlight_item);
	}
        
    if (menu_data->menu_item_str_list)
	{
        for(i = 0; i < nNumofItem; i++)
        {
            cui_menu_set_item_string(menu_cui_id, menu_id[i], (WCHAR*)menu_data->menu_item_str_list[i]);
        }
        if (menu_data->menu_item_str_id_list)
    	{
    	    ASSERT(0);
    	}
	}
    else if (menu_data->menu_item_str_id_list)
	{
        for(i = 0; i < nNumofItem; i++)
        {
            cui_menu_set_item_string_by_id(menu_cui_id, menu_id[i], menu_data->menu_item_str_id_list[i]);
        }	    
	}
    else if(menu_data->menu_item_str_cb)
    {
        for(i = 0; i < nNumofItem; i++)
        {
            const S32 reqLen = menu_data->menu_item_str_cb(i, NULL, 0);
            WCHAR *name_buf = (WCHAR*)OslMalloc(reqLen * sizeof(WCHAR));
            if(name_buf)
            {
                menu_data->menu_item_str_cb(i, name_buf, reqLen);
                cui_menu_set_item_string(menu_cui_id, menu_id[i], name_buf);
                OslMfree(name_buf);
                name_buf = NULL;
            }            
        }
    }
    else
    {
        ASSERT(0);
    }

    /* Free the menu id list */
    OslMfree(menu_id);    
    
}


/*****************************************************************************
 * FUNCTION
 *  mmi_phnset_init_on_off_radio_button_menu
 * DESCRIPTION
 *  Init a radio button menu only contains on & off selection 
 * PARAMETERS
 *  void
 * RETURNS
 *  static void
 *****************************************************************************/
void mmi_phnset_init_on_off_radio_button_menu(MMI_ID group_id, U16 title_id, U16 icon_id, U8 highlight_item)
{
    /*----------------------------------------------------------------*/
    /* Local Variables                                                */
    /*----------------------------------------------------------------*/
    U16 on_off_strid_p[2] = {STR_GLOBAL_OFF, STR_GLOBAL_ON};
    phnset_radio_button_menu_data_struct on_off_menu_data;
        
    /*----------------------------------------------------------------*/
    /* Code Body                                                      */
    /*----------------------------------------------------------------*/
    on_off_menu_data.group_id = group_id;
    on_off_menu_data.menu_title_str_id = title_id;
    on_off_menu_data.menu_icon_id = icon_id;
    on_off_menu_data.menu_item_num = 2;
    on_off_menu_data.menu_item_str_list = NULL;
    on_off_menu_data.menu_item_str_id_list = on_off_strid_p;
    on_off_menu_data.highlighted_item_idx = highlight_item;
    
    mmi_phnset_init_radio_button_menu(&on_off_menu_data);
}

