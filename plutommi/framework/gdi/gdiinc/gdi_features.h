/*****************************************************************************
*  Copyright Statement:
*  --------------------
*  This software is protected by Copyright and the information contained
*  herein is confidential. The software may not be copied and the information
*  contained herein may not be used or disclosed except with the written
*  permission of MediaTek Inc. (C) 2005
*
*  BY OPENING THIS FILE, BUYER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES
*  THAT THE SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")
*  RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE PROVIDED TO BUYER ON
*  AN "AS-IS" BASIS ONLY. MEDIATEK EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,
*  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
*  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NONINFRINGEMENT.
*  NEITHER DOES MEDIATEK PROVIDE ANY WARRANTY WHATSOEVER WITH RESPECT TO THE
*  SOFTWARE OF ANY THIRD PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR
*  SUPPLIED WITH THE MEDIATEK SOFTWARE, AND BUYER AGREES TO LOOK ONLY TO SUCH
*  THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERETO. MEDIATEK SHALL ALSO
*  NOT BE RESPONSIBLE FOR ANY MEDIATEK SOFTWARE RELEASES MADE TO BUYER'S
*  SPECIFICATION OR TO CONFORM TO A PARTICULAR STANDARD OR OPEN FORUM.
*
*  BUYER'S SOLE AND EXCLUSIVE REMEDY AND MEDIATEK'S ENTIRE AND CUMULATIVE
*  LIABILITY WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE,
*  AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIATEK SOFTWARE AT ISSUE,
*  OR REFUND ANY SOFTWARE LICENSE FEES OR SERVICE CHARGE PAID BY BUYER TO
*  MEDIATEK FOR SUCH MEDIATEK SOFTWARE AT ISSUE.
*
*  THE TRANSACTION CONTEMPLATED HEREUNDER SHALL BE CONSTRUED IN ACCORDANCE
*  WITH THE LAWS OF THE STATE OF CALIFORNIA, USA, EXCLUDING ITS CONFLICT OF
*  LAWS PRINCIPLES.  ANY DISPUTES, CONTROVERSIES OR CLAIMS ARISING THEREOF AND
*  RELATED THERETO SHALL BE SETTLED BY ARBITRATION IN SAN FRANCISCO, CA, UNDER
*  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
*
*****************************************************************************/

/*******************************************************************************
 * Filename:
 * ---------
 *  gdi_features.h
 *
 * Project:
 * --------
 *  MAUI
 *
 * Description:
 * ------------
 *  GDI Features Set.
 *
 * Author:
 * -------
 * -------
 *==============================================================================
 *             HISTORY
 * Below this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *------------------------------------------------------------------------------
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 * removed!
 * removed!
 * removed!
 *
 *------------------------------------------------------------------------------
 * Upper this line, this part is controlled by PVCS VM. DO NOT MODIFY!!
 *==============================================================================
 *******************************************************************************/
#ifndef _GDI_FEATURES_H_
#define _GDI_FEATURES_H_

#include "drv_sw_features_display.h"
#include "drv_sw_features_g2d.h"
#include "drv_sw_features_jpeg.h"
#include "drv_sw_features_gif.h"
#include "drv_sw_features_mdp.h"


#if defined(DRV_LCD_4_BYTES_ALIGN)
    #define GDI_LCD_4_BYTES_ALIGN
#elif defined(DRV_LCD_8_BYTES_ALIGN)
    #define GDI_LCD_8_BYTES_ALIGN
#endif

#if DRV_LAYER_TOTAL_COUNT == 6
    #define GDI_USING_MUTEX
    #define GDI_USING_LAYER
    #define GDI_6_LAYERS
    #define GDI_LAYER_HW_LAYER_COUNT       DRV_LAYER_TOTAL_COUNT
    #define GDI_LAYER_TREE_MAX_DEPTH       8
#elif DRV_LAYER_TOTAL_COUNT == 4
    #define GDI_USING_MUTEX
    #define GDI_USING_LAYER
    #define GDI_4_LAYERS
    #define GDI_LAYER_HW_LAYER_COUNT       DRV_LAYER_TOTAL_COUNT
    #define GDI_LAYER_TREE_MAX_DEPTH       8
#elif DRV_LAYER_TOTAL_COUNT == 2 /* in 6223, code use 2 layer internally, but 4 layer in the interface */
    #define GDI_USING_MUTEX
    #define GDI_USING_LAYER
    #define GDI_2_LAYERS
    /* in 6223, the interface still use 4 layer to simplify code */
    #define GDI_LAYER_HW_LAYER_COUNT        4
    #define GDI_LAYER_TREE_MAX_DEPTH        8
#elif DRV_LAYER_TOTAL_COUNT == 1 /* in 6205B , code still use 4 layer, but no hardware layer feature */
    #define GDI_LAYER_HW_LAYER_COUNT 4
    #define GDI_LAYER_TREE_MAX_DEPTH 4
#else
    #error "GDI don't understand DRV_LAYER_TOTAL_COUNT"
#endif

/*
 *  non-blocking decoding will not be force aborted more than GDI_NB_FORCE_ABORT_COUNT_MAX times.
 *  This macro is added to prevent nb decoding always aborted because some application (ex.JAVA) always use GDI background.
 */
#define GDI_NB_FORCE_ABORT_COUNT_MAX    3

#if defined(TV_OUT_SUPPORT) && defined(DRV_LCD_MEMORY_OUTPUT)
    #define GDI_USING_TV_OUTPUT
#endif

#if defined(DRV_LCD_ROI_BACKGROUND_COLOR)
    #define GDI_USING_LAYER_BACKGROUND
#endif

#if defined(DRV_LCD_MEMORY_OUTPUT)
    #define GDI_USING_LAYER_OUTPUT_ANOTHER_MEMORY
#endif

#if defined(DRV_LAYER_COLOR_FORMAT)
#define GDI_USING_LAYER_COLOR_FORMAT
#endif

#if defined(__GOVL_SUPPORT__)
#define GDI_GOVL_SUPPORT
#endif

/* Support PARGB6666 flatten */
#if ((!defined(GDI_GOVL_SUPPORT) && defined(LCD_LAYER_SOURCE_COLOR_PARGB6666)) || (defined(GDI_GOVL_SUPPORT) && defined(FLATTEN_LAYER_SOURCE_COLOR_PARGB6666))) &&(!defined(__GFX_SLIM_COLOR_FORMAT__) || defined(__MMI_FTE_SUPPORT__)) //__GFX_SLIM_COLOR_FORMAT__ is for low-cost slim project
#define GDI_LAYER_PARGB6666_FLATTEN_SUPPORT
#endif

#ifdef FLATTEN_DRIVER_CONTEXT_DITHER_SUPPORT
#define GDI_FLATTEN_RESULT_DITHER_SUPPORT
#endif

#if defined(GDI_LAYER_PARGB6666_FLATTEN_SUPPORT)
/* Support creating PARGB6666 layer and primitive operations */
#define GDI_LAYER_PARGB6666_SUPPORT
#endif

#if defined(LCD_LAYER_SOURCE_COLOR_PARGB8888)
#define GDI_LCD_MEMORY_OUTPUT_PARGB8888_SUPPORT
#endif


/*
 * general layer information
 */
#define GDI_LAYER_CLIP_STACK_COUNT        (16)
#define GDI_LAYER_ACT_LAYER_STACK_COUNT      (8)

#define GDI_LAYER_OFFSET    0


#if defined(__LCM_SCANLINE_ROTATION_SUPPORT__)

#if defined(__MAIN_LCM_SCANLINE_ROTATION_90__)
#define GDI_MAINLCD_SCANLINE_ROTATION_90
#endif
#if defined(__MAIN_LCM_SCANLINE_ROTATION_270__)
#define GDI_MAINLCD_SCANLINE_ROTATION_270
#endif
#if defined(GDI_MAINLCD_SCANLINE_ROTATION_90) || defined(GDI_MAINLCD_SCANLINE_ROTATION_270)
#define GDI_MAINLCD_SCANLINE_ROTATION
#endif

#if defined(__MMI_SUBLCD__)
#if defined(__SUB_LCM_SCANLINE_ROTATION_90__)
#define GDI_SUBLCD_SCANLINE_ROTATION_90
#endif
#if defined(__SUB_LCM_SCANLINE_ROTATION_270__)
#define GDI_SUBLCD_SCANLINE_ROTATION_270
#endif
#endif /* __MMI_SUBLCD__ */
#if defined(__SUB_LCM_SCANLINE_ROTATION_90__) || defined(__SUB_LCM_SCANLINE_ROTATION_270__)
#define GDI_SUBLCD_SCANLINE_ROTATION
#endif

#if defined(__MAIN_LCM_SCANLINE_ROTATION_180__) || defined(__MAIN_LCM_SCANLINE_ROTATION_180__)
#error "GDI will not handle SCANLINE_ROTATION_180"
#endif

#if defined(GDI_MAINLCD_SCANLINE_ROTATION) || defined(GDI_SUBLCD_SCANLINE_ROTATION)
#define GDI_LCD_SCANLINE_ROTATION
#endif

#if defined(GDI_MAINLCD_SCANLINE_ROTATION)
#define __GDI_BLT_WITH_DOUBLE_BUF_SUPPORT__
#endif
#endif /* __LCM_SCANLINE_ROTATION_SUPPORT__ */

/* opera browser use at lease 5 layer handles, and media player use 7 handles, SSE use 3 handles. */
/* when opera lunch media player, layer handle may not enough, so we add layer handle to 24 */
#if defined(GDI_USING_LAYER) && (defined(__VENUS_UI_ENGINE__) || defined(OPERA_BROWSER))
/* We need use one extra layer handle to flatten and blt for SCANLINE */
#define GDI_LAYER_LAYER_COUNT          (24)
#else
#ifdef GDI_FULL_SUPPORT
#define GDI_LAYER_LAYER_COUNT          (18)
#else
#define GDI_LAYER_LAYER_COUNT          (12)
#endif
#endif

#define GDI_LAYER_TOTAL_LAYER_COUNT GDI_LAYER_LAYER_COUNT

#if defined(GDI_LCD_SCANLINE_ROTATION)
#if defined(GDI_MAINLCD_SCANLINE_ROTATION) && defined(GDI_SUBLCD_SCANLINE_ROTATION)
#undef GDI_LAYER_TOTAL_LAYER_COUNT
#define GDI_LAYER_TOTAL_LAYER_COUNT          ((GDI_LAYER_LAYER_COUNT) + 2)
#else
#undef GDI_LAYER_TOTAL_LAYER_COUNT
#define GDI_LAYER_TOTAL_LAYER_COUNT          ((GDI_LAYER_LAYER_COUNT) + 1)
#endif
#endif

/* define total_layer_count as max(4, DRV_LAYER_TOTAL_COUNT) */
#if (DRV_LAYER_TOTAL_COUNT > GDI_LAYER_TOTAL_LAYER_COUNT)
#undef GDI_LAYER_TOTAL_LAYER_COUNT
#define GDI_LAYER_TOTAL_LAYER_COUNT DRV_LAYER_TOTAL_COUNT
#endif

/*
 *  GIF
 */

#ifdef __GIF_DECODER_SUPPORT__
#define GDI_USING_GIF

#if defined(__HW_GIF_SUPPORT__) && defined(__MTK_TARGET__)
#define GDI_USING_HW_GIF
#endif

#endif /* __GIF_DECODER_SUPPORT__ */


/* To support "restore to background" disposal method, switch on this compile option.
   It needs 2*LCD_SIZE buffer to remeber the background before drawing gif image.
   This feature also clear the bg before gif frame_0. */
#ifdef __MMI_GIF_DISPOSAL_RESTORE_TO_BG__
#define GDI_USING_GIF_DISPOSAL
#endif

/*
 *  G2D
 */
/* 
 * Single bank
 */
#ifdef __SINGLE_BANK_NOR_FLASH_SUPPORT__
    /* Single-bank dose not support font caching even using a temp buffer */
    #undef GDI_USING_2D_ENGINE_V3
#endif

#if defined(__HW_G2D_SUPPORT__)
    /* Actually V3 has the same capability as V2, 
       but the driver interface is revised. 
       We will start to use 2D V3 since MT6238 */
    #define GDI_USING_2D_ENGINE_V3

    #if defined(__HW_G2D_AA_FONT_SUPPORT__)
        #define GDI_AA_FONT_SUPPORT
    #endif
    #if defined(__HW_G2D_TILT_FONT_SUPPORT__)
        #define GDI_TILT_FONT_SUPPORT
    #endif
#endif

#ifdef __HW_G2D_RECT_FILL_SUPPORT__
/* Support HW version of gdi_2d_fill_rect().
   If not defined, gdi_2d_fill_rect() will be redirected to SW implementation. */
#define GDI_G2D_FILL_RECT_SUPPORT
#endif

#ifdef WIN32
    #undef GDI_USING_2D_ENGINE_V3
#endif /* WIN32 */

#if defined(DRV_LAYER_ROTATE)
#define GDI_USING_LAYER_ROTATE
#endif

#if defined(LCM_ROTATE_SUPPORT)
#define GDI_USING_LCD_ROTATE
#endif

#if defined(SVG_SUPPORT)
#define GDI_USING_SVG
#endif

#if defined(MDP_SUPPORT_IMAGE_EFFECT)
    #define GDI_USING_ISP
#endif

///////////////////////////////////////////////////////////////
/// JPEG
#if defined (JPG_DECODE)
    #define GDI_USING_HW_JPEG_V2

    #ifdef EXIF_SUPPORT
        #define GDI_USING_JPEG_EXIF
    #endif
    
    #if defined(__JPEG_DEC_HW_SUPPORTED__) && defined(__MTK_TARGET__)
        #define GDI_USING_HW_JPG
    #endif
#endif /* defined (JPG_DECODE) */

#if defined(JPG_ENCODE)
    #define GDI_USING_JPEG_ENCODE_V2
#endif /* defined (JPG_ENCODE) */

//////////////////////////////////////////////////////////////
/// RESIZER

#ifdef MDP_SUPPORT_RGB_RESIZE
    #define GDI_USING_HW_RESIZER

    #if defined(DRV_IDP_OLD_DESIGN)
        #ifdef DRV_IMG_PITCH_MODE_SUPPORT
            #define GDI_HW_RESIZER_PITCH_MODE
        #endif
    #else   /* defined(DRV_IDP_OLD_DESIGN) */
        #define GDI_USING_HW_RESIZER_V2
    #endif  /* defined(DRV_IDP_OLD_DESIGN) */
#endif

//////////////////////////////////////////////////////////////
/// PNG
#if defined(USE_SW_PNG_DECODER) || defined(USE_HW_PNG_DECODER) || defined(USE_HW_PNG_DECODER_V1)/* V1 not used currently*/
#define GDI_USING_PNG

#if defined(USE_HW_PNG_DECODER) && defined(__MTK_TARGET__)
#define GDI_USING_HW_PNG
#else
    #define GDI_USING_SW_PNG
#endif

#endif /* defined(USE_SW_PNG_DECODER) || defined(USE_HW_PNG_DECODER) || defined(USE_HW_PNG_DECODER_V1) */

//////////////////////////////////////////////////////////////
/// Palette control
#if DRV_PALETTE_COUNT == 0
    /* If LCD driver doesn't support palette, GDI still keep one palette for drawing 8-bit layer. */
    /* If DRV_PALETTE_COUNT==0, 8-bit layer is only for drawing, not for blt. */
    #define GDI_SUPPORT_PALETTES    1
#else
    #define GDI_SUPPORT_PALETTES     DRV_PALETTE_COUNT
#endif

#if defined (DRV_PALETTE_RGB_888)
    #define GDI_LCD_PALETTE_SUPPORT_RGB_888
    #define GDI_PALETTE_COLOR_FROM_RGB     gd_color_from_rgb_24
    #define GDI_PALETTE_COLOR_TO_RGB       gd_color_to_rgb_24
#elif defined(DRV_PALETTE_RGB_565)
    #define GDI_LCD_PALETTE_SUPPORT_RGB_565
    #define GDI_PALETTE_COLOR_FROM_RGB     gd_color_from_rgb_16
    #define GDI_PALETTE_COLOR_TO_RGB       gd_color_to_rgb_16
#else
    #define GDI_LCD_PALETTE_SUPPORT_NONE
    #define GDI_PALETTE_COLOR_FROM_RGB     gd_color_from_rgb_16
    #define GDI_PALETTE_COLOR_TO_RGB       gd_color_to_rgb_16
#endif


// For MOS/Windows simulator.
#ifdef WIN32
#undef GDI_USING_HW_GIF
#undef GDI_USING_HW_RESIZER
#undef GDI_USING_LCD_ROTATE
#endif /* WIN32 */


//#if defined(M3D_MMI_SUPPORT)
//    #define GDI_USING_M3D
//#endif

#ifdef GDI_USING_M3D
    #ifdef __MMI_AVATAR__
        #define GDI_USING_AVATAR
    #endif
#endif

#if defined(__GDI_SCREEN_SHOT_BUFFER__)
    #define GDI_USING_SCREEN_SHOT_BUFFER
#endif


#if defined(__SPATIAL_DITHERING__) /*&& !defined(LOW_COST_SUPPORT)*/
#define GDI_USING_DITHERING
#endif

#if defined(__SPATIAL_DITHERING__) && defined(__HW_G2D_DITHERING_SUPPORT__)
    #define GDI_9SLICE_USING_LINEAR_TRANSFORM 
#endif


#if defined(__MMI_BASIC_UI_STYLE__)
#define GDI_SLIM_SUPPORT
#endif

#if !defined(__MMI_BASIC_UI_STYLE__) || defined(WAP_SUPPORT) || defined(__MMI_MMS__)
#define GDI_USING_WBMP
#endif

#if !defined(__MMI_BASIC_UI_STYLE__) || defined(__J2ME__) || !defined(__MMI_MRE_DISABLE_FMGR__)
#define GDI_USING_PBM 
#endif


#if defined(GDI_SLIM_SUPPORT) && !defined(GDI_USING_DITHERING) && !(defined(MAIN_MEDIA_LAYER_BITS_PER_PIXEL) && (MAIN_MEDIA_LAYER_BITS_PER_PIXEL == 24))
/* If this option is defined, RGB888 is not supported. */
#define GDI_SLIM_COLOR_FORMAT
#endif


#if !defined(GDI_SLIM_COLOR_FORMAT) || defined(GDI_LAYER_PARGB6666_SUPPORT)
/* Support of 24-bit operations for RGB888 or PARGB6666 */
#define GDI_PRIMITIVE_24_BIT_SUPPORT
#endif

/*#define GDI_FULL_SUPPORT*/
/*#define UI_BUFFER_MODE_SWITCH*/

#if defined(__COSMOS_MMI_PACKAGE__) || (defined(__MMI_FTE_SUPPORT__) && defined(__VENUS_UI_ENGINE__))
#define GDI_NB_BLT_SUPPORT
#define GDI_IMGDEC_ADJUST_ASPECT_SUPPORT
#endif

#ifdef __MMI_CAMCORDER__
#define GDI_COLORFORMAT8_PALETTE
#endif

#if defined(GDI_USING_SVG) || defined(GDI_USING_M3D) || defined(GDI_USING_AVATAR)
#define GDI_IMGDEC_SUPPORT_DRAW_BEFORE_AFTER
#endif
#endif /* _GDI_FEATURES_H_ */

